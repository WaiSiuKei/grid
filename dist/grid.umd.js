!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self,t.NilaGrid=e())}(this,function(){"use strict";function t(t,e){function n(){this.constructor=t}St(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function e(t,e,n,i){return new(n||(n=Promise))(function(o,r){function s(t){try{h(i.next(t))}catch(t){r(t)}}function l(t){try{h(i.throw(t))}catch(t){r(t)}}function h(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,l)}h((i=i.apply(t,e||[])).next())})}function n(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,r&&(s=2&n[0]?r.return:n[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,n[1])).done)return s;switch(r=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return h.label++,{value:n[1],done:!1};case 5:h.label++,r=n[1],n=[0];continue;case 7:n=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){h=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){h.label=n[1];break}if(6===n[0]&&h.label<s[1]){h.label=s[1],s=n;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(n);break}s[2]&&h.ops.pop(),h.trys.pop();continue}n=e.call(t,h)}catch(t){n=[6,t],r=0}finally{o=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,r,s,l,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l}function i(t){if(!t.parent||t.parent===t)return null;try{var e=t.location,n=t.parent.location;if(e.protocol!==n.protocol||e.hostname!==n.hostname||e.port!==n.port)return bt=!0,null}catch(t){return bt=!0,null}return t.parent}function o(t,e){for(var n,i=t.document.getElementsByTagName("iframe"),o=0,r=i.length;o<r;o++)if((n=i[o]).contentWindow===e)return n;return null}function r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Array.isArray(t)?(t.forEach(function(t){return t&&t.dispose()}),[]):0!==e.length?(r(t),r(e),[]):t?(t.dispose(),t):void 0}function s(t){return{dispose:function(){return r(t)}}}function l(t){return{dispose:function(){t()}}}function h(t){u(t)||Bt.onUnexpectedError(t)}function u(t){return t instanceof Error&&t.name===Vt&&t.message===Vt}function a(t,e,n,i){return new Zt(t,e,n,i)}function c(t,e){return a(t,"mouseout",function(n){for(var i=n.relatedTarget||n.target;i&&i!==t;)i=i.parentNode;i!==t&&e(n)})}function d(t,e,n,i,o){return new ee(t,e,n,i,o)}function p(t){if(!ne){var e=function(t){return setTimeout(function(){return t((new Date).getTime())},0)};ne=self.requestAnimationFrame||self.msRequestAnimationFrame||self.webkitRequestAnimationFrame||self.mozRequestAnimationFrame||self.oRequestAnimationFrame||e}return ne.call(self,t)}function f(t){return document.defaultView.getComputedStyle(t,null)}function m(t,e,n){var i=f(t),o="0";return i&&(o=i.getPropertyValue?i.getPropertyValue(e):i.getAttribute(n)),re(t,o)}function _(t){var e=t.getBoundingClientRect();return{left:e.left+le.scrollX,top:e.top+le.scrollY,width:e.width,height:e.height}}function g(t){var e=se.getBorderLeftWidth(t)+se.getBorderRightWidth(t),n=se.getPaddingLeft(t)+se.getPaddingRight(t);return t.offsetWidth-e-n}function v(t){var e=se.getBorderTopWidth(t)+se.getBorderBottomWidth(t),n=se.getPaddingTop(t)+se.getPaddingBottom(t);return t.offsetHeight-e-n}function y(t){return new ue(t)}function S(t,e){var n=new Ft(e);return n.preventDefault(),{leftButton:n.leftButton,posx:n.posx,posy:n.posy}}function w(t){var e,n=this,i=!1;return function(){return i?e:(i=!0,e=t.apply(n,arguments))}}function b(t,e){return t.reduce(function(t,n){return t+n[e]},0)}function N(t){return t.reduce(function(t,e){return t+e},0)}function C(t,e){return t.map(function(t){return t[e]})}function x(t,e){var n=e-t;return function(e){return t+n*D(e)}}function R(t,e,n){return function(i){return i<n?t(i/n):e((i-n)/(1-n))}}function E(t){return Math.pow(t,3)}function D(t){return 1-E(1-t)}function A(t){var e={lazyRender:void 0!==t.lazyRender&&t.lazyRender,className:void 0!==t.className?t.className:"",useShadows:void 0===t.useShadows||t.useShadows,handleMouseWheel:void 0===t.handleMouseWheel||t.handleMouseWheel,flipAxes:void 0!==t.flipAxes&&t.flipAxes,alwaysConsumeMouseWheel:void 0!==t.alwaysConsumeMouseWheel&&t.alwaysConsumeMouseWheel,scrollYToX:void 0!==t.scrollYToX&&t.scrollYToX,mouseWheelScrollSensitivity:void 0!==t.mouseWheelScrollSensitivity?t.mouseWheelScrollSensitivity:1,fastScrollSensitivity:void 0!==t.fastScrollSensitivity?t.fastScrollSensitivity:5,mouseWheelSmoothScroll:void 0===t.mouseWheelSmoothScroll||t.mouseWheelSmoothScroll,listenOnDomNode:void 0!==t.listenOnDomNode?t.listenOnDomNode:null,horizontal:void 0!==t.horizontal?t.horizontal:1,horizontalScrollbarSize:void 0!==t.horizontalScrollbarSize?t.horizontalScrollbarSize:10,horizontalSliderSize:void 0!==t.horizontalSliderSize?t.horizontalSliderSize:0,vertical:void 0!==t.vertical?t.vertical:1,verticalScrollbarSize:void 0!==t.verticalScrollbarSize?t.verticalScrollbarSize:10,verticalSliderSize:void 0!==t.verticalSliderSize?t.verticalSliderSize:0};return e.horizontalSliderSize=void 0!==t.horizontalSliderSize?t.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=void 0!==t.verticalSliderSize?t.verticalSliderSize:e.verticalScrollbarSize,It&&(e.className+=" mac"),e}function M(t,e,n){return t>=e?e:t<=n?n:t}function L(t){return Array.isArray?Array.isArray(t):!(!t||typeof t.length!==xe.number||t.constructor!==Array)}function O(t){return typeof t===xe.string||t instanceof String}function P(t){return typeof t===xe.function}function z(t){return void 0===t||null===t}function T(t,e){if(Array.isArray(t))for(let n=0,i=t.length;n<i;n++)T(t[n],e);else e.push(t)}function k(t){if(null==t)return t;let e=[];return T(t,e),1===e.length&&(e=e[0]),e}function W(){if(We.component){var t=We.component.getName();if(t)return" Check the render method of `"+t+"`."}return""}function I(t,e,n,i,o){return{type:t,key:e,ref:n,props:i,_owner:o}}function H(t){if(t){if(Array.isArray(t)){let e={};for(let n=0;n<t.length;++n){let i=H(t[n]);if(i)for(let t in i)e[t]=i[t]}return e}return t}}function F(t,e,n){if(null==t)throw Error("createElement: type should not be null or undefined."+W());let i,o={},r=null,s=null;if(null!=e){s=void 0===e.ref?null:e.ref,r=void 0===e.key?null:String(e.key);for(i in e)Ie[i]||(o[i]=e[i])}const l=arguments.length-2;if(l>0)if(1!==l||Array.isArray(n)){let t=n;if(l>1){t=new Array(l);for(var h=0;h<l;h++)t[h]=arguments[h+2]}o.children=k(t)}else o.children=n;if(t&&t.defaultProps){let e=t.defaultProps;for(i in e)void 0===o[i]&&(o[i]=e[i])}return o.style&&(Array.isArray(o.style)||"object"==typeof o.style)&&(o.style=H(o.style)),new I(t,r,s,o,We.component)}function j(){const t=We.component._instance;if(t)return t;throw new Error("Hooks can only be called inside a component.")}function U(t,e){for(let n=0;n<t.length;n++){const i=t[n],o=e[n];if((i!==o||0===i&&1/i!=1/o)&&(i===i||o===o))return!1}return!0}function B(t,e){G(t,e,!0)}function V(t,e){G(t,e)}function G(t,e,n){const i=j(),o=i.getCurrentHookId(),r=i.hooks;if(i.isComponentRendered()){const n=r[o],{create:create,inputs:prevInputs}=n;n.inputs=e,n.prevInputs=prevInputs,create.current=t}else{const s=t=>{if(!t&&n)return Ue(()=>s(!0));const{current:current}=s;current&&(l.current=current(),s.current=null)},l=t=>{if(!t&&n)return Ue(()=>l(!0));const{current:current}=l;current?(current(),l.current=null):n&&(s(!0),l(!0))};s.current=t,i.hooks[o]={create:s,destory:l,prevInputs:e,inputs:e},i.didMountHandlers.push(s),i.willUnmountHandlers.push(l),i.didUpdateHandlers.push(()=>{const{prevInputs:prevInputs,inputs:inputs,create:create}=r[o];null!=prevInputs&&U(inputs,prevInputs)||(l(!0),create())})}}function X(t){let e=un.get(t);return!!e&&(un.remove(t),e._internal.unmountComponent(),!0)}function Y(t,e){let n=null===t,i=null===e;if(n||i)return n===i;let o=typeof t,r=typeof e;return"string"===o||"number"===o?"string"===r||"number"===r:"object"===o&&"object"===r&&t.type===e.type&&t.key===e.key}function K(t,e){if(e){let n=t._pendingCallbacks||(t._pendingCallbacks=[]);n.push(e)}}function Q(t,e){if(e){let n=t._pendingStateQueue||(t._pendingStateQueue=[]);n.push(e)}}function $(t,e){return t===e?0!==t||1/t==1/e:t!==t&&e!==e}function q(t,e){if($(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;let n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(let i=0;i<n.length;i++)if(!nn.call(e,n[i])||!$(t[n[i]],e[n[i]]))return!1;return!0}function Z(t,e,n){try{return t()}catch(t){n?n(t):J(e,t)}}function J(t,e){let n;for(;t;){if("function"==typeof t.componentDidCatch){n=t;break}if(!t._internal||!t._internal._parentInstance)break;t=t._internal._parentInstance}if(n){const t=n._internal;if(t){let i=t._pendingCallbacks||(t._pendingCallbacks=[]);i.push(()=>n.componentDidCatch(e))}}else setTimeout(()=>{throw e},0)}function tt(t){let e;if(void 0===t||null===t||!1===t||!0===t)e=new Ye;else if(Array.isArray(t))e=new Ze(t);else if("object"==typeof t&&t.type)e="string"==typeof t.type?new qe(t):new on(t);else{if("string"!=typeof t&&"number"!=typeof t)throw new Error(`Invalid element type: ${t}. (current: ${"object"==typeof t&&Object.keys(t)||typeof t})`);e=new rn(t)}return e._mountIndex=0,e}function et(t,e,n,i){"function"==typeof n&&(i=n,n=null),n=n||{};let o=un.mount(t,e,n.parent).getPublicInstance();return i&&i.call(o),o}function nt(t,e){return function(){return an.createElement("div",null,t.key.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}}function it(t,e,n){return function(){return an.createElement("div",null,n+": "+e)}}function ot(t,e){switch(void 0===e&&(e=0),typeof t){case"object":return null===t?rt(349,e):Array.isArray(t)?ht(t,e):ut(t,e);case"string":return lt(t,e);case"boolean":return st(t,e);case"number":return rt(t,e);case"undefined":return rt(0,937);default:return rt(0,617)}}function rt(t,e){return(e<<5)-e+t|0}function st(t,e){return rt(t?433:863,e)}function lt(t,e){e=rt(149417,e);for(var n=0,i=t.length;n<i;n++)e=rt(t.charCodeAt(n),e);return e}function ht(t,e){return e=rt(104579,e),t.reduce(function(t,e){return ot(e,t)},e)}function ut(t,e){return e=rt(181387,e),Object.keys(t).sort().reduce(function(e,n){return e=lt(n,e),ot(t[n],e)},e)}function at(t,e,n){for(var i=t.length,o=e.length,r=i+o,s={1:0},l=0;l<=r;++l)for(var h=-l;h<=l;h+=2){for(var u=void 0,a=(u=h===-l||h!==l&&s[h-1]+1<s[h+1]?s[h+1]:s[h-1]+1)-h;u<i&&a<o&&n(t[u],e[a]);)u++,a++;if(u===i&&a===o)return l;s[h]=u}return-1}function ct(t,e,n,i,o,r,s,l,h,u,a){var c,d,p,f;if(0===s)return void a("same",t,e,n,i,o,r);if(s===n-e+(r-o))return void((l&dn.horizontal?1:0)+(h&dn.vertical?1:0)>=(l&dn.vertical?1:0)+(h&dn.horizontal?1:0)?(e!==n&&a("remove",t,e,n,i,o,o),o!==r&&a("add",t,n,n,i,o,r)):(o!==r&&a("add",t,e,e,i,o,r),e!==n&&a("remove",t,e,n,i,r,r)));for(var m=n-e,_=r-o,g=Math.floor(_/2),v={},y=-s-1;y<=s+1;++y)v[y]={d:1/0,segments:0,direct:dn.none};for(var S=(c={},c[-s-1]={d:1/0,segments:0,direct:dn.none},c[s+1]={d:1/0,segments:0,direct:dn.none},c),w=0;w<=g;++w){v=(d=[S,v])[0],S=d[1];for(y=-s;y<=s;++y)!function(n){var r=w+n;if(0===w&&0===r)return v[n]={d:0,segments:0,direct:l},"continue";var s=[{direct:dn.horizontal,d:v[n-1].d+1,segments:v[n-1].segments+(v[n-1].direct&dn.horizontal?0:1)},{direct:dn.vertical,d:S[n+1].d+1,segments:S[n+1].segments+(S[n+1].direct&dn.vertical?0:1)}];r>0&&r<=m&&w>0&&w<=_&&u(t[e+r-1],i[o+w-1])&&s.push({direct:dn.diagonal,d:S[n].d,segments:S[n].segments+(S[n].direct&dn.diagonal?0:1)});var h=s.reduce(function(t,e){return t.d>e.d?e:t.d===e.d&&t.segments>e.segments?e:t});s.forEach(function(t){h.d===t.d&&h.segments===t.segments&&(h.direct|=t.direct)}),v[n]=h}(y)}for(var b={},y=-s-1;y<=s+1;++y)b[y]={d:1/0,segments:0,direct:dn.none};for(var N=(p={},p[-s-1]={d:1/0,segments:0,direct:dn.none},p[s+1]={d:1/0,segments:0,direct:dn.none},p),w=_;w>=g;--w){b=(f=[N,b])[0],N=f[1];for(y=s;y>=-s;--y)!function(n){var r=w+n;if(w===_&&r===m)return b[n]={d:0,segments:0,direct:h},"continue";var s=[{direct:dn.horizontal,d:b[n+1].d+1,segments:b[n+1].segments+(b[n+1].direct&dn.horizontal?0:1)},{direct:dn.vertical,d:N[n-1].d+1,segments:N[n-1].segments+(N[n-1].direct&dn.vertical?0:1)}];r>=0&&r<m&&w>=0&&w<_&&u(t[e+r],i[o+w])&&s.push({direct:dn.diagonal,d:N[n].d,segments:N[n].segments+(N[n].direct&dn.diagonal?0:1)});var l=s.reduce(function(t,e){return t.d>e.d?e:t.d===e.d&&t.segments>e.segments?e:t});s.forEach(function(t){l.d===t.d&&l.segments===t.segments&&(l.direct|=t.direct)}),b[n]=l}(y)}for(var C={k:-1,d:1/0,segments:0,direct:dn.none},y=-s;y<=s;++y){var x=v[y].d+b[y].d;if(x<C.d)C.k=y,C.d=x,C.segments=v[y].segments+b[y].segments+(v[y].segments&b[y].segments?0:1),C.direct=b[y].direct;else if(x===C.d){var R=v[y].segments+b[y].segments+(v[y].segments&b[y].segments?0:1);R<C.segments?(C.k=y,C.d=x,C.segments=R,C.direct=b[y].direct):R===C.segments&&!(C.direct&dn.diagonal)&&b[y].direct&dn.diagonal&&(C.k=y,C.d=x,C.segments=R,C.direct=b[y].direct)}}g+C.k===0&&0===g&&(g++,v[C.k].direct=b[C.k].direct,b[C.k].direct=N[C.k].direct),ct(t,e,e+g+C.k,i,o,o+g,v[C.k].d,l,b[C.k].direct,u,a),ct(t,e+g+C.k,n,i,o+g,r,b[C.k].d,v[C.k].direct,h,u,a)}function dt(t,e,n,i){var o=at(t,e,n);ct(t,0,t.length,e,0,e.length,o,dn.diagonal,dn.all,n,i)}function pt(t,e,n){function i(t,e,n,i,l,h,u){if("same"===t)s&&o.push(s),r&&o.push(r),s=null,r=null;else if("remove"===t){s||(s={type:mn.Remove,oldPos:n,newPos:h,items:[]});for(a=n;a<i;++a)s.items.push(e[a]);r&&(r.oldPos+=i-n,s.oldPos===n&&(s.newPos-=i-n))}else if("add"===t){r||(r={type:mn.Add,oldPos:n,newPos:h,items:[]});for(var a=h;a<u;++a)r.items.push(l[a])}}void 0===n&&(n=function(t,e){return t===e});var o=[],r=null,s=null;return dt(t,e,n,i),i("same",[],0,0,[],0,0),o}function ft(t){return JSON.stringify(t)}function mt(t){return P(t)?t:function(e){return e[t]}}function _t(t,e,n){return function(){return an.createElement("div",null,(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}}function gt(t){return Object.assign({},yn,t)}function vt(t,e,n){var i=[],o=Sn;e&&(o.width=e,o.flexGrow=0,o.flexShrink=0),n&&Object.assign(o,{formatter:n});for(var r=0;r<t.length;r++){var s=Object.assign({},o,t[r]);s.flexGrow=Math.max(0,s.flexGrow),s.flexShrink=Math.max(0,s.flexShrink),z(s.minWidth)&&(0===s.flexShrink?s.minWidth=s.width:s.minWidth=1),s.width<s.minWidth&&(s.width=s.minWidth),z(s.maxWidth)&&(0===s.flexGrow?s.maxWidth=s.width:s.maxWidth=1/0),s.width>s.maxWidth&&(s.width=s.maxWidth),i.push(s)}return i}function yt(t,e){var n=e-b(t,"width");if(0!==n){var i=C(t,n>0?"flexGrow":"flexShrink"),o=Math.max(1,N(i));if(0!==o)for(var r=0,s=t.length;r<s;r++)t[r].width+=n*i[r]/o}}var St=function(t,e){return(St=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},wt=function(){return(wt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t}).apply(this,arguments)},bt=!1,Nt=null,Ct=function(){function t(){}return t.getSameOriginWindowChain=function(){if(!Nt){Nt=[];var t,e=window;do{(t=i(e))?Nt.push({window:e,iframeElement:o(t,e)}):Nt.push({window:e,iframeElement:null}),e=t}while(e)}return Nt.slice(0)},t.hasDifferentOriginAncestor=function(){return Nt||this.getSameOriginWindowChain(),bt},t.getPositionOfChildWindowRelativeToAncestorWindow=function(t,e){if(!e||t===e)return{top:0,left:0};for(var n=0,i=0,o=this.getSameOriginWindowChain(),r=0;r<o.length;r++){var s=o[r];if(s.window===e)break;if(!s.iframeElement)break;var l=s.iframeElement.getBoundingClientRect();n+=l.top,i+=l.left}return{top:n,left:i}},t}(),xt=navigator.userAgent,Rt=xt.indexOf("Trident")>=0,Et=xt.indexOf("Edge/")>=0,Dt=(xt.indexOf("Opera"),xt.indexOf("Firefox"),xt.indexOf("AppleWebKit"),xt.indexOf("Chrome"),-1===xt.indexOf("Chrome")&&xt.indexOf("Safari")>=0),At=(xt.indexOf("iPad"),Et&&xt.indexOf("WebView/"),!1),Mt=!1,Lt="undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.electron&&"renderer"===process.type;if("object"!=typeof navigator||Lt){if("object"==typeof process){At="win32"===process.platform,Mt="darwin"===process.platform,"linux"===process.platform,"en";var Ot=process.env.VSCODE_NLS_CONFIG;if(Ot)try{var Pt=JSON.parse(Ot);Pt.availableLanguages["*"];Pt.locale,Pt._translationsConfigFile}catch(t){}}}else{var zt=navigator.userAgent;At=zt.indexOf("Windows")>=0,Mt=zt.indexOf("Macintosh")>=0,zt.indexOf("Linux")>=0,navigator.language}var Tt;!function(t){t[t.Web=0]="Web",t[t.Mac=1]="Mac",t[t.Linux=2]="Linux",t[t.Windows=3]="Windows"}(Tt||(Tt={}));var kt,Wt=At,It=Mt;!function(t){t[t.Windows=1]="Windows",t[t.Macintosh=2]="Macintosh",t[t.Linux=3]="Linux"}(kt||(kt={}));var Ht,Ft=function(){function t(t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=0===t.button,this.middleButton=1===t.button,this.rightButton=2===t.button,this.target=t.target,this.detail=t.detail||1,"dblclick"===t.type&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,"number"==typeof t.pageX?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.posy=t.clientY+document.body.scrollTop+document.documentElement.scrollTop);var e=Ct.getPositionOfChildWindowRelativeToAncestorWindow(self,t.view);this.posx-=e.left,this.posy-=e.top}return t.prototype.preventDefault=function(){this.browserEvent.preventDefault&&this.browserEvent.preventDefault()},t.prototype.stopPropagation=function(){this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()},t}(),jt=(function(e){function n(t){var n=e.call(this,t)||this;return n.dataTransfer=t.dataTransfer,n}t(n,e)}(Ft),function(){function t(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.browserEvent=t||null,this.target=t?t.target||t.targetNode||t.srcElement:null,this.deltaY=n,this.deltaX=e,t){var i=t,o=t;void 0!==i.wheelDeltaY?this.deltaY=i.wheelDeltaY/120:void 0!==o.VERTICAL_AXIS&&o.axis===o.VERTICAL_AXIS&&(this.deltaY=-o.detail/3),void 0!==i.wheelDeltaX?this.deltaX=Dt&&Wt?-i.wheelDeltaX/120:i.wheelDeltaX/120:void 0!==o.HORIZONTAL_AXIS&&o.axis===o.HORIZONTAL_AXIS&&(this.deltaX=-t.detail/3),0===this.deltaY&&0===this.deltaX&&t.wheelDelta&&(this.deltaY=t.wheelDelta/120)}}return t.prototype.preventDefault=function(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()},t.prototype.stopPropagation=function(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()},t}()),Ut=function(){function t(){this._toDispose=[],this._lifecycle_disposable_isDisposed=!1}return Object.defineProperty(t.prototype,"toDispose",{get:function(){return this._toDispose},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._lifecycle_disposable_isDisposed=!0,this._toDispose=r(this._toDispose)},t.prototype._register=function(t){return this._lifecycle_disposable_isDisposed?(console.warn("Registering disposable on object that has already been disposed."),t.dispose()):this._toDispose.push(t),t},t.None=Object.freeze({dispose:function(){}}),t}(),Bt=new(function(){function t(){this.listeners=[],this.unexpectedErrorHandler=function(t){setTimeout(function(){if(t.stack)throw new Error(t.message+"\n\n"+t.stack);throw t},0)}}return t.prototype.addListener=function(t){var e=this;return this.listeners.push(t),function(){e._removeListener(t)}},t.prototype.emit=function(t){this.listeners.forEach(function(e){e(t)})},t.prototype._removeListener=function(t){this.listeners.splice(this.listeners.indexOf(t),1)},t.prototype.setUnexpectedErrorHandler=function(t){this.unexpectedErrorHandler=t},t.prototype.getUnexpectedErrorHandler=function(){return this.unexpectedErrorHandler},t.prototype.onUnexpectedError=function(t){this.unexpectedErrorHandler(t),this.emit(t)},t.prototype.onUnexpectedExternalError=function(t){this.unexpectedErrorHandler(t)},t}()),Vt="Canceled",Gt=function(e){function n(t,n){var i=e.call(this)||this;return i._token=-1,"function"==typeof t&&"number"==typeof n&&i.setIfNotSet(t,n),i}return t(n,e),n.prototype.dispose=function(){this.cancel(),e.prototype.dispose.call(this)},n.prototype.cancel=function(){-1!==this._token&&(clearTimeout(this._token),this._token=-1)},n.prototype.cancelAndSet=function(t,e){var n=this;this.cancel(),this._token=setTimeout(function(){n._token=-1,t()},e)},n.prototype.setIfNotSet=function(t,e){var n=this;-1===this._token&&(this._token=setTimeout(function(){n._token=-1,t()},e))},n}(Ut),Xt=new(function(){function t(){}return t.prototype._findClassName=function(t,e){var n=t.className;if(!n)return void(this._lastStart=-1);e=e.trim();var i=n.length,o=e.length;if(0===o)return void(this._lastStart=-1);if(i<o)return void(this._lastStart=-1);if(n===e)return this._lastStart=0,void(this._lastEnd=i);for(var r,s=-1;(s=n.indexOf(e,s+1))>=0;){if(r=s+o,(0===s||32===n.charCodeAt(s-1))&&32===n.charCodeAt(r))return this._lastStart=s,void(this._lastEnd=r+1);if(s>0&&32===n.charCodeAt(s-1)&&r===i)return this._lastStart=s-1,void(this._lastEnd=r);if(0===s&&r===i)return this._lastStart=0,void(this._lastEnd=r)}this._lastStart=-1},t.prototype.hasClass=function(t,e){return this._findClassName(t,e),-1!==this._lastStart},t.prototype.addClasses=function(t){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];n.forEach(function(n){return n.split(" ").forEach(function(n){return e.addClass(t,n)})})},t.prototype.addClass=function(t,e){t.className?(this._findClassName(t,e),-1===this._lastStart&&(t.className=t.className+" "+e)):t.className=e},t.prototype.removeClass=function(t,e){this._findClassName(t,e),-1!==this._lastStart&&(t.className=t.className.substring(0,this._lastStart)+t.className.substring(this._lastEnd))},t.prototype.removeClasses=function(t){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];n.forEach(function(n){return n.split(" ").forEach(function(n){return e.removeClass(t,n)})})},t.prototype.toggleClass=function(t,e,n){this._findClassName(t,e),-1===this._lastStart||void 0!==n&&n||this.removeClass(t,e),-1!==this._lastStart||void 0!==n&&!n||this.addClass(t,e)},t}()),Yt=new(function(){function t(){}return t.prototype.hasClass=function(t,e){return Boolean(e)&&t.classList&&t.classList.contains(e)},t.prototype.addClasses=function(t){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];n.forEach(function(n){return n.split(" ").forEach(function(n){return e.addClass(t,n)})})},t.prototype.addClass=function(t,e){e&&t.classList&&t.classList.add(e)},t.prototype.removeClass=function(t,e){e&&t.classList&&t.classList.remove(e)},t.prototype.removeClasses=function(t){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];n.forEach(function(n){return n.split(" ").forEach(function(n){return e.removeClass(t,n)})})},t.prototype.toggleClass=function(t,e,n){t.classList&&t.classList.toggle(e,n)},t}()),Kt=Rt?Xt:Yt,Qt=(Kt.hasClass.bind(Kt),Kt.addClass.bind(Kt)),$t=Kt.addClasses.bind(Kt),qt=(Kt.removeClass.bind(Kt),Kt.removeClasses.bind(Kt),Kt.toggleClass.bind(Kt)),Zt=function(){function t(t,e,n,i){this._node=t,this._type=e,this._handler=n,this._useCapture=i||!1,this._node.addEventListener(this._type,this._handler,this._useCapture)}return t.prototype.dispose=function(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._useCapture),this._node=null,this._handler=null)},t}(),Jt=16,te=function(t,e){return e},ee=function(e){function n(t,n,i,o,r){void 0===o&&(o=te),void 0===r&&(r=Jt);var s=e.call(this)||this,l=null,h=0,u=s._register(new Gt),c=function(){h=(new Date).getTime(),i(l),l=null};return s._register(a(t,n,function(t){l=o(l,t);var e=(new Date).getTime()-h;e>=r?(u.cancel(),c()):u.setIfNotSet(c,r-e)})),s}return t(n,e),n}(Ut),ne=null,ie=function(){function t(t,e){void 0===e&&(e=0),this._runner=t,this.priority=e,this._canceled=!1}return t.prototype.dispose=function(){this._canceled=!0},t.prototype.execute=function(){if(!this._canceled)try{this._runner()}catch(t){h(t)}},t.sort=function(t,e){return e.priority-t.priority},t}();!function(){var t=[],e=null,n=!1,i=function(){for(n=!1,e=t,t=[];e.length>0;)e.sort(ie.sort),e.shift().execute()};Ht=function(e,o){void 0===o&&(o=0);var r=new ie(e,o);return t.push(r),n||(n=!0,p(i)),r}}();var oe,re=function(){return function(t,e){return parseFloat(e)||0}}(),se={getBorderLeftWidth:function(t){return m(t,"border-left-width","borderLeftWidth")},getBorderRightWidth:function(t){return m(t,"border-right-width","borderRightWidth")},getBorderTopWidth:function(t){return m(t,"border-top-width","borderTopWidth")},getBorderBottomWidth:function(t){return m(t,"border-bottom-width","borderBottomWidth")},getPaddingLeft:function(t){return m(t,"padding-left","paddingLeft")},getPaddingRight:function(t){return m(t,"padding-right","paddingRight")},getPaddingTop:function(t){return m(t,"padding-top","paddingTop")},getPaddingBottom:function(t){return m(t,"padding-bottom","paddingBottom")},getMarginLeft:function(t){return m(t,"margin-left","marginLeft")},getMarginTop:function(t){return m(t,"margin-top","marginTop")},getMarginRight:function(t){return m(t,"margin-right","marginRight")},getMarginBottom:function(t){return m(t,"margin-bottom","marginBottom")},__commaSentinel:!1},le=new(function(){function t(){}return Object.defineProperty(t.prototype,"scrollX",{get:function(){return"number"==typeof window.scrollX?window.scrollX:document.body.scrollLeft+document.documentElement.scrollLeft},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollY",{get:function(){return"number"==typeof window.scrollY?window.scrollY:document.body.scrollTop+document.documentElement.scrollTop},enumerable:!0,configurable:!0}),t}()),he={CLICK:"click",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",UNLOAD:"unload",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend"},ue=function(){function t(t){this.domNode=t,this._maxWidth=-1,this._width=-1,this._height=-1,this._top=-1,this._left=-1,this._bottom=-1,this._right=-1,this._fontFamily="",this._fontWeight="",this._fontSize=-1,this._lineHeight=-1,this._letterSpacing=-100,this._className="",this._display="",this._position="",this._visibility="",this._layerHint=!1}return t.prototype.setMaxWidth=function(t){this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth+"px")},t.prototype.setWidth=function(t){this._width!==t&&(this._width=t,this.domNode.style.width=this._width+"px")},t.prototype.setHeight=function(t){this._height!==t&&(this._height=t,this.domNode.style.height=this._height+"px")},t.prototype.setTop=function(t){this._top!==t&&(this._top=t,this.domNode.style.top=this._top+"px")},t.prototype.unsetTop=function(){-1!==this._top&&(this._top=-1,this.domNode.style.top="")},t.prototype.setLeft=function(t){this._left!==t&&(this._left=t,this.domNode.style.left=this._left+"px")},t.prototype.setBottom=function(t){this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom+"px")},t.prototype.setRight=function(t){this._right!==t&&(this._right=t,this.domNode.style.right=this._right+"px")},t.prototype.setFontFamily=function(t){this._fontFamily!==t&&(this._fontFamily=t,this.domNode.style.fontFamily=this._fontFamily)},t.prototype.setFontWeight=function(t){this._fontWeight!==t&&(this._fontWeight=t,this.domNode.style.fontWeight=this._fontWeight)},t.prototype.setFontSize=function(t){this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize+"px")},t.prototype.setLineHeight=function(t){this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight+"px")},t.prototype.setLetterSpacing=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing+"px")},t.prototype.setClassName=function(t){this._className!==t&&(this._className=t,this.domNode.className=this._className)},t.prototype.toggleClassName=function(t,e){qt(this.domNode,t,e),this._className=this.domNode.className},t.prototype.setDisplay=function(t){this._display!==t&&(this._display=t,this.domNode.style.display=this._display)},t.prototype.setPosition=function(t){this._position!==t&&(this._position=t,this.domNode.style.position=this._position)},t.prototype.setVisibility=function(t){this._visibility!==t&&(this._visibility=t,this.domNode.style.visibility=this._visibility)},t.prototype.setLayerHinting=function(t){this._layerHint!==t&&(this._layerHint=t,this.domNode.style.willChange=this._layerHint?"transform":"auto")},t.prototype.setAttribute=function(t,e){this.domNode.setAttribute(t,e)},t.prototype.removeAttribute=function(t){this.domNode.removeAttribute(t)},t.prototype.appendChild=function(t){this.domNode.appendChild(t.domNode)},t.prototype.removeChild=function(t){this.domNode.removeChild(t.domNode)},t}(),ae=function(e){function n(){var t=e.call(this)||this;return t.hooks=[],t.mouseMoveEventMerger=null,t.mouseMoveCallback=null,t.onStopCallback=null,t}return t(n,e),n.prototype.dispose=function(){this.stopMonitoring(!1),e.prototype.dispose.call(this)},n.prototype.stopMonitoring=function(t){if(this.isMonitoring()){this.hooks=r(this.hooks),this.mouseMoveEventMerger=null,this.mouseMoveCallback=null;var e=this.onStopCallback;this.onStopCallback=null,t&&e&&e()}},n.prototype.isMonitoring=function(){return this.hooks.length>0},n.prototype.startMonitoring=function(t,e,n){var i=this;if(!this.isMonitoring()){this.mouseMoveEventMerger=t,this.mouseMoveCallback=e,this.onStopCallback=n;for(var o=Ct.getSameOriginWindowChain(),r=0;r<o.length;r++)this.hooks.push(d(o[r].window.document,"mousemove",function(t){return i.mouseMoveCallback(t)},function(t,e){return i.mouseMoveEventMerger(t,e)})),this.hooks.push(a(o[r].window.document,"mouseup",function(t){return i.stopMonitoring(!0)}));if(Ct.hasDifferentOriginAncestor()){var s=o[o.length-1];this.hooks.push(a(s.window.document,"mouseout",function(t){"html"===new Ft(t).target.tagName.toLowerCase()&&i.stopMonitoring(!0)})),this.hooks.push(a(s.window.document,"mouseover",function(t){"html"===new Ft(t).target.tagName.toLowerCase()&&i.stopMonitoring(!0)})),this.hooks.push(a(s.window.document.body,"mouseleave",function(t){i.stopMonitoring(!0)}))}}},n}(Ut),ce=function(e){function n(t,n,i){var o=e.call(this)||this;return o._visibility=t,o._visibleClassName=n,o._invisibleClassName=i,o._domNode=null,o._isVisible=!1,o._isNeeded=!1,o._shouldBeVisible=!1,o._revealTimer=o._register(new Gt),o}return t(n,e),n.prototype.applyVisibilitySetting=function(t){return 2!==this._visibility&&(3===this._visibility||t)},n.prototype.setShouldBeVisible=function(t){var e=this.applyVisibilitySetting(t);this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())},n.prototype.setIsNeeded=function(t){this._isNeeded!==t&&(this._isNeeded=t,this.ensureVisibility())},n.prototype.setDomNode=function(t){this._domNode=t,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)},n.prototype.ensureVisibility=function(){if(!this._isNeeded)return void this._hide(!1);this._shouldBeVisible?this._reveal():this._hide(!0)},n.prototype._reveal=function(){var t=this;this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(function(){t._domNode&&t._domNode.setClassName(t._visibleClassName)},0))},n.prototype._hide=function(t){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode&&this._domNode.setClassName(this._invisibleClassName+(t?" fade":"")))},n}(Ut),de=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.onclick=function(t,e){this._register(a(t,he.CLICK,function(t){return e(new Ft(t))}))},n.prototype.onmousedown=function(t,e){this._register(a(t,he.MOUSE_DOWN,function(t){return e(new Ft(t))}))},n.prototype.onmouseover=function(t,e){this._register(a(t,he.MOUSE_OVER,function(t){return e(new Ft(t))}))},n.prototype.onnonbubblingmouseout=function(t,e){this._register(c(t,function(t){return e(new Ft(t))}))},n.prototype.onblur=function(t,e){this._register(a(t,he.BLUR,e))},n.prototype.onfocus=function(t,e){this._register(a(t,he.FOCUS,e))},n}(Ut),pe=function(e){function n(t){var n=e.call(this)||this;return n._lazyRender=t.lazyRender,n._host=t.host,n._scrollable=t.scrollable,n._scrollbarState=t.scrollbarState,n._visibilityController=n._register(new ce(t.visibility,"visible scrollbar "+t.extraScrollbarClassName,"invisible scrollbar "+t.extraScrollbarClassName)),n._mouseMoveMonitor=n._register(new ae),n._shouldRender=!0,n.domNode=y(document.createElement("div")),n.domNode.setAttribute("role","presentation"),n.domNode.setAttribute("aria-hidden","true"),n._visibilityController.setDomNode(n.domNode),n.domNode.setPosition("absolute"),n.onmousedown(n.domNode.domNode,function(t){return n._domNodeMouseDown(t)}),n}return t(n,e),n.prototype._createSlider=function(t,e,n,i){var o=this;this.slider=y(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(t),this.slider.setLeft(e),"number"==typeof n&&this.slider.setWidth(n),"number"==typeof i&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.domNode.domNode.appendChild(this.slider.domNode),this.onmousedown(this.slider.domNode,function(t){t.leftButton&&(t.preventDefault(),o._sliderMouseDown(t,function(){}))})},n.prototype._onElementSize=function(t){return this._scrollbarState.setVisibleSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender},n.prototype._onElementScrollSize=function(t){return this._scrollbarState.setScrollSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender},n.prototype._onElementScrollPosition=function(t){return this._scrollbarState.setScrollPosition(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender},n.prototype.beginReveal=function(){this._visibilityController.setShouldBeVisible(!0)},n.prototype.beginHide=function(){this._visibilityController.setShouldBeVisible(!1)},n.prototype.render=function(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getSliderPosition()))},n.prototype._domNodeMouseDown=function(t){t.target===this.domNode.domNode&&this._onMouseDown(t)},n.prototype.delegateMouseDown=function(t){var e=this.domNode.domNode.getClientRects()[0].top,n=e+this._scrollbarState.getSliderPosition(),i=e+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),o=this._sliderMousePosition(t);n<=o&&o<=i?t.leftButton&&(t.preventDefault(),this._sliderMouseDown(t,function(){})):this._onMouseDown(t)},n.prototype._onMouseDown=function(t){var e,n;if(t.target===this.domNode.domNode&&"number"==typeof t.browserEvent.offsetX&&"number"==typeof t.browserEvent.offsetY)e=t.browserEvent.offsetX,n=t.browserEvent.offsetY;else{var i=_(this.domNode.domNode);e=t.posx-i.left,n=t.posy-i.top}this._setDesiredScrollPositionNow(this._scrollbarState.getDesiredScrollPositionFromOffset(this._mouseDownRelativePosition(e,n))),t.leftButton&&(t.preventDefault(),this._sliderMouseDown(t,function(){}))},n.prototype._sliderMouseDown=function(t,e){var n=this,i=this._sliderMousePosition(t),o=this._sliderOrthogonalMousePosition(t),r=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._mouseMoveMonitor.startMonitoring(S,function(t){var e=n._sliderOrthogonalMousePosition(t),s=Math.abs(e-o);if(Wt&&s>140)return void n._setDesiredScrollPositionNow(r.getScrollPosition());var l=n._sliderMousePosition(t)-i;n._setDesiredScrollPositionNow(r.getDesiredScrollPositionFromDelta(l))},function(){n.slider.toggleClassName("active",!1),n._host.onDragEnd(),e()}),this._host.onDragStart()},n.prototype._setDesiredScrollPositionNow=function(t){var e={};this.writeScrollPosition(e,t),this._scrollable.setScrollPositionNow(e)},n}(de),fe=function(){function t(t,e){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(e),this._visibleSize=0,this._scrollSize=0,this._scrollPosition=0,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}return t.prototype.clone=function(){var e=new t(this._scrollbarSize,this._oppositeScrollbarSize);return e.setVisibleSize(this._visibleSize),e.setScrollSize(this._scrollSize),e.setScrollPosition(this._scrollPosition),e},t.prototype.setVisibleSize=function(t){var e=Math.round(t);return this._visibleSize!==e&&(this._visibleSize=e,this._refreshComputedValues(),!0)},t.prototype.setScrollSize=function(t){var e=Math.round(t);return this._scrollSize!==e&&(this._scrollSize=e,this._refreshComputedValues(),!0)},t.prototype.setScrollPosition=function(t){var e=Math.round(t);return this._scrollPosition!==e&&(this._scrollPosition=e,this._refreshComputedValues(),!0)},t._computeValues=function(t,e,n,i){var o=Math.max(0,e-t),r=Math.max(0,o),s=n>0&&n>e;if(!s)return{computedAvailableSize:Math.round(o),computedIsNeeded:s,computedSliderSize:Math.round(r),computedSliderRatio:0,computedSliderPosition:0};var l=Math.round(Math.max(20,Math.floor(e*r/n))),h=(r-l)/(n-e),u=i*h;return{computedAvailableSize:Math.round(o),computedIsNeeded:s,computedSliderSize:Math.round(l),computedSliderRatio:h,computedSliderPosition:Math.round(u)}},t.prototype._refreshComputedValues=function(){var e=t._computeValues(this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition},t.prototype.getScrollPosition=function(){return this._scrollPosition},t.prototype.getRectangleLargeSize=function(){return this._computedAvailableSize},t.prototype.getRectangleSmallSize=function(){return this._scrollbarSize},t.prototype.isNeeded=function(){return this._computedIsNeeded},t.prototype.getSliderSize=function(){return this._computedSliderSize},t.prototype.getSliderPosition=function(){return this._computedSliderPosition},t.prototype.getDesiredScrollPositionFromOffset=function(t){if(!this._computedIsNeeded)return 0;var e=t-this._computedSliderSize/2;return Math.round(e/this._computedSliderRatio)},t.prototype.getDesiredScrollPositionFromDelta=function(t){if(!this._computedIsNeeded)return 0;var e=this._computedSliderPosition+t;return Math.round(e/this._computedSliderRatio)},t}(),me=function(e){function n(t,n,i){var o=e.call(this,{lazyRender:n.lazyRender,host:i,scrollbarState:new fe(2===n.horizontal?0:n.horizontalScrollbarSize,2===n.vertical?0:n.verticalScrollbarSize),visibility:n.horizontal,extraScrollbarClassName:"horizontal",scrollable:t})||this;return o._createSlider(Math.floor((n.horizontalScrollbarSize-n.horizontalSliderSize)/2),0,void 0,n.horizontalSliderSize),o}return t(n,e),n.prototype._updateSlider=function(t,e){this.slider.setWidth(t),this.slider.setLeft(e)},n.prototype._renderDomNode=function(t,e){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setLeft(0),this.domNode.setBottom(0)},n.prototype.onDidScroll=function(t){return this._shouldRender=this._onElementScrollSize(t.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(t.width)||this._shouldRender,this._shouldRender},n.prototype._mouseDownRelativePosition=function(t,e){return t},n.prototype._sliderMousePosition=function(t){return t.posx},n.prototype._sliderOrthogonalMousePosition=function(t){return t.posy},n.prototype.writeScrollPosition=function(t,e){t.scrollLeft=e},n}(pe),_e=function(e){function n(t,n,i){var o=e.call(this,{lazyRender:n.lazyRender,host:i,scrollbarState:new fe(2===n.vertical?0:n.verticalScrollbarSize,0),visibility:n.vertical,extraScrollbarClassName:"vertical",scrollable:t})||this;return o._createSlider(0,Math.floor((n.verticalScrollbarSize-n.verticalSliderSize)/2),n.verticalSliderSize,void 0),o}return t(n,e),n.prototype._updateSlider=function(t,e){this.slider.setHeight(t),this.slider.setTop(e)},n.prototype._renderDomNode=function(t,e){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setRight(0),this.domNode.setTop(0)},n.prototype.onDidScroll=function(t){return this._shouldRender=this._onElementScrollSize(t.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(t.height)||this._shouldRender,this._shouldRender},n.prototype._mouseDownRelativePosition=function(t,e){return e},n.prototype._sliderMousePosition=function(t){return t.posy},n.prototype._sliderOrthogonalMousePosition=function(t){return t.posx},n.prototype.writeScrollPosition=function(t,e){t.scrollTop=e},n}(pe),ge={done:!0,value:void 0};!function(t){function e(){return h}function n(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=t.length),{next:function(){return e>=n?ge:{done:!1,value:t[e++]}}}}function i(e){return e?Array.isArray(e)?t.fromArray(e):e:t.empty()}function o(t,e){return{next:function(){var n=t.next();return n.done?ge:{done:!1,value:e(n.value)}}}}function r(t,e){return{next:function(){for(;;){var n=t.next();if(n.done)return ge;if(e(n.value))return{done:!1,value:n.value}}}}}function s(t,e){for(var n=t.next();!n.done;n=t.next())e(n.value)}function l(t){var e=[];return s(t,function(t){return e.push(t)}),e}var h={next:function(){return ge}};t.empty=e,t.fromArray=n,t.from=i,t.map=o,t.filter=r,t.forEach=s,t.collect=l}(oe||(oe={}));(function(e){function n(t,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=t.length),void 0===o&&(o=n-1),e.call(this,t,n,i,o)||this}t(n,e),n.prototype.current=function(){return e.prototype.current.call(this)},n.prototype.previous=function(){return this.index=Math.max(this.index-1,this.start-1),this.current()},n.prototype.first=function(){return this.index=this.start,this.current()},n.prototype.last=function(){return this.index=this.end-1,this.current()},n.prototype.parent=function(){return null}})(function(){function t(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=t.length),void 0===i&&(i=e-1),this.items=t,this.start=e,this.end=n,this.index=i}return t.prototype.first=function(){return this.index=this.start,this.current()},t.prototype.next=function(){return this.index=Math.min(this.index+1,this.end),this.current()},t.prototype.current=function(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]},t}()),function(e){function n(t,n){var i=e.call(this,t,n)||this;return i.navigator=t,i}t(n,e),n.prototype.current=function(){return this.fn(this.navigator.current())},n.prototype.previous=function(){return this.fn(this.navigator.previous())},n.prototype.parent=function(){return this.fn(this.navigator.parent())},n.prototype.first=function(){return this.fn(this.navigator.first())},n.prototype.last=function(){return this.fn(this.navigator.last())},n.prototype.next=function(){return this.fn(this.navigator.next())}}(function(){function t(t,e){this.iterator=t,this.fn=e}return t.prototype.next=function(){return this.fn(this.iterator.next())},t}());var ve,ye=function(){function t(t){this.element=t}return t}(),Se=function(){function t(){this._size=0}return Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return!this._first},t.prototype.clear=function(){this._first=void 0,this._last=void 0,this._size=0},t.prototype.unshift=function(t){return this._insert(t,!1)},t.prototype.push=function(t){return this._insert(t,!0)},t.prototype._insert=function(t,e){var n=new ye(t);if(this._first)if(e){var i=this._last;this._last=n,n.prev=i,i.next=n}else{var o=this._first;this._first=n,n.next=o,o.prev=n}else this._first=n,this._last=n;return this._size+=1,this._remove.bind(this,n)},t.prototype.shift=function(){if(this._first){var t=this._first.element;return this._remove(this._first),t}},t.prototype.pop=function(){if(this._last){var t=this._last.element;return this._remove(this._last),t}},t.prototype._remove=function(t){for(var e=this._first;e instanceof ye;){if(e===t){if(e.prev&&e.next){var n=e.prev;n.next=e.next,e.next.prev=n}else e.prev||e.next?e.next?e.prev||(this._first=this._first.next,this._first.prev=void 0):(this._last=this._last.prev,this._last.next=void 0):(this._first=void 0,this._last=void 0);this._size-=1;break}e=e.next}},t.prototype.iterator=function(){var t,e=this._first;return{next:function(){return e?(t?t.value=e.element:t={done:!1,value:e.element},e=e.next,t):ge}}},t.prototype.toArray=function(){for(var t=[],e=this._first;e instanceof ye;e=e.next)t.push(e.element);return t},t}();!function(t){function e(t){return function(e,n,i){void 0===n&&(n=null);var o=!1,r=t(function(t){if(!o)return r?r.dispose():o=!0,e.call(n,t)},null,i);return o&&r.dispose(),r}}function n(t,e){return function(n,i,o){return void 0===i&&(i=null),t(function(t){return n.call(i,e(t))},null,o)}}function i(t,e){return function(n,i,o){return void 0===i&&(i=null),t(function(t){e(t),n.call(i,t)},null,o)}}function o(t,e){return function(n,i,o){return void 0===i&&(i=null),t(function(t){return e(t)&&n.call(i,t)},null,o)}}function r(t){return t}function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e,n,i){return void 0===n&&(n=null),s(t.map(function(t){return t(function(t){return e.call(n,t)},null,i)}))}}function h(t,e){var i=void 0;return n(t,function(t){return i=e(i,t)})}function u(t,e,n,i,o){void 0===n&&(n=100),void 0===i&&(i=!1);var r,s=void 0,l=void 0,h=0,u=new Ce({leakWarningThreshold:o,onFirstListenerAdd:function(){r=t(function(t){h++,s=e(s,t),i&&!l&&u.fire(s),clearTimeout(l),l=setTimeout(function(){var t=s;s=void 0,l=void 0,(!i||h>1)&&u.fire(t),h=0},n)})},onLastListenerRemove:function(){r.dispose()}});return u.event}function a(t){var i=(new Date).getTime();return n(e(t),function(t){return(new Date).getTime()-i})}function c(t){var e,n=!0;return o(t,function(t){var i=n||t!==e;return n=!1,e=t,i})}function d(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=[]);var i=n.slice(),o=t(function(t){i?i.push(t):s.fire(t)}),r=function(){i&&i.forEach(function(t){return s.fire(t)}),i=null},s=new Ce({onFirstListenerAdd:function(){o||(o=t(function(t){return s.fire(t)}))},onFirstListenerDidAdd:function(){i&&(e?setTimeout(r):r())},onLastListenerRemove:function(){o&&o.dispose(),o=null}});return s.event}function p(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=[]),n=n.slice(),t(function(t){n.push(t),o.fire(t)});var i=function(t,e){return n.forEach(function(n){return t.call(e,n)})},o=new Ce({onListenerDidAdd:function(t,n,o){e?setTimeout(function(){return i(n,o)}):i(n,o)}});return o.event}function f(t){return new y(t)}function m(t,e,n){void 0===n&&(n=function(t){return t});var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.fire(n.apply(void 0,t))},o=new Ce({onFirstListenerAdd:function(){return t.on(e,i)},onLastListenerRemove:function(){return t.removeListener(e,i)}});return o.event}function _(t){var e=new Ce,n=!1;return t.then(void 0,function(){return null}).then(function(){n?e.fire():setTimeout(function(){return e.fire()},0)}),n=!0,e.event}function g(t){return new Promise(function(n){return e(t)(n)})}var v={dispose:function(){}};t.None=function(){return v},t.once=e,t.map=n,t.forEach=i,t.filter=o,t.signal=r,t.any=l,t.reduce=h,t.debounce=u,t.stopwatch=a,t.latch=c,t.buffer=d,t.echo=p;var y=function(){function t(t){this._event=t}return Object.defineProperty(t.prototype,"event",{get:function(){return this._event},enumerable:!0,configurable:!0}),t.prototype.map=function(e){return new t(n(this._event,e))},t.prototype.forEach=function(e){return new t(i(this._event,e))},t.prototype.filter=function(e){return new t(o(this._event,e))},t.prototype.latch=function(){return new t(c(this._event))},t.prototype.on=function(t,e,n){return this._event(t,e,n)},t.prototype.once=function(t,n,i){return e(this._event)(t,n,i)},t}();t.chain=f,t.fromNodeEventEmitter=m,t.fromPromise=_,t.toPromise=g}(ve||(ve={}));var we,be=-1,Ne=function(){function t(t,e){void 0===e&&(e=Math.random().toString(18).slice(2,5)),this.customThreshold=t,this.name=e,this._warnCountdown=0}return t.prototype.dispose=function(){this._stacks&&this._stacks.clear()},t.prototype.check=function(t){var e=this,n=be;if("number"==typeof this.customThreshold&&(n=this.customThreshold),!(n<=0||t<n)){this._stacks||(this._stacks=new Map);var i=(new Error).stack.split("\n").slice(3).join("\n"),o=this._stacks.get(i)||0;if(this._stacks.set(i,o+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=.5*n;var r,s=0;this._stacks.forEach(function(t,e){(!r||s<t)&&(r=e,s=t)}),console.warn("["+this.name+"] potential listener LEAK detected, having "+t+" listeners already. MOST frequent listener ("+s+"):"),console.warn(r)}return function(){var t=e._stacks.get(i)||0;e._stacks.set(i,t-1)}}},t}(),Ce=function(){function t(t){this._disposed=!1,this._options=t,this._leakageMon=be>0?new Ne(this._options&&this._options.leakWarningThreshold):void 0}return Object.defineProperty(t.prototype,"event",{get:function(){var e=this;return this._event||(this._event=function(n,i,o){e._listeners||(e._listeners=new Se);var r=e._listeners.isEmpty();r&&e._options&&e._options.onFirstListenerAdd&&e._options.onFirstListenerAdd(e);var s=e._listeners.push(i?[n,i]:n);r&&e._options&&e._options.onFirstListenerDidAdd&&e._options.onFirstListenerDidAdd(e),e._options&&e._options.onListenerDidAdd&&e._options.onListenerDidAdd(e,n,i);var l;e._leakageMon&&(l=e._leakageMon.check(e._listeners.size));var h;return h={dispose:function(){l&&l(),h.dispose=t._noop,e._disposed||(s(),e._options&&e._options.onLastListenerRemove&&(e._listeners&&!e._listeners.isEmpty()||e._options.onLastListenerRemove(e)))}},Array.isArray(o)&&o.push(h),h}),this._event},enumerable:!0,configurable:!0}),t.prototype.fire=function(t){if(this._listeners){this._deliveryQueue||(this._deliveryQueue=[]);for(var e=this._listeners.iterator(),n=e.next();!n.done;n=e.next())this._deliveryQueue.push([n.value,t]);for(;this._deliveryQueue.length>0;){var i=this._deliveryQueue.shift(),o=i[0],r=i[1];try{"function"==typeof o?o.call(void 0,r):o[0].call(o[1],r)}catch(n){h(n)}}}},t.prototype.dispose=function(){this._listeners&&(this._listeners=void 0),this._deliveryQueue&&(this._deliveryQueue.length=0),this._leakageMon&&this._leakageMon.dispose(),this._disposed=!0},t._noop=function(){},t}();(function(i){function o(){return null!==i&&i.apply(this,arguments)||this}t(o,i),o.prototype.fireAsync=function(t){return e(this,void 0,void 0,function(){var e,i,o,r,s,l;return n(this,function(n){switch(n.label){case 0:if(!this._listeners)return[2];for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=[]),e=this._listeners.iterator(),i=e.next();!i.done;i=e.next())l=[],this._asyncDeliveryQueue.push([i.value,t(l,"function"==typeof i.value?i.value:i.value[0]),l]);n.label=1;case 1:if(!(this._asyncDeliveryQueue.length>0))return[3,3];o=this._asyncDeliveryQueue.shift(),r=o[0],s=o[1],l=o[2];try{"function"==typeof r?r.call(void 0,s):r[0].call(r[1],s)}catch(t){return h(t),[3,1]}return Object.freeze(l),[4,Promise.all(l)];case 2:return n.sent(),[3,1];case 3:return[2]}})})}})(Ce),function(){function t(){var t=this;this.hasListeners=!1,this.events=[],this.emitter=new Ce({onFirstListenerAdd:function(){return t.onFirstListenerAdd()},onLastListenerRemove:function(){return t.onLastListenerRemove()}})}Object.defineProperty(t.prototype,"event",{get:function(){return this.emitter.event},enumerable:!0,configurable:!0}),t.prototype.add=function(t){var e=this,n={event:t,listener:null};return this.events.push(n),this.hasListeners&&this.hook(n),l(w(function(){e.hasListeners&&e.unhook(n);var t=e.events.indexOf(n);e.events.splice(t,1)}))},t.prototype.onFirstListenerAdd=function(){var t=this;this.hasListeners=!0,this.events.forEach(function(e){return t.hook(e)})},t.prototype.onLastListenerRemove=function(){var t=this;this.hasListeners=!1,this.events.forEach(function(e){return t.unhook(e)})},t.prototype.hook=function(t){var e=this;t.listener=t.event(function(t){return e.emitter.fire(t)})},t.prototype.unhook=function(t){t.listener&&t.listener.dispose(),t.listener=null},t.prototype.dispose=function(){this.emitter.dispose()}}(),function(){function t(){var t=this;this.listening=!1,this.inputEvent=ve.None,this.inputEventListener=Ut.None,this.emitter=new Ce({onFirstListenerDidAdd:function(){t.listening=!0,t.inputEventListener=t.inputEvent(t.emitter.fire,t.emitter)},onLastListenerRemove:function(){t.listening=!1,t.inputEventListener.dispose()}}),this.event=this.emitter.event}Object.defineProperty(t.prototype,"input",{set:function(t){this.inputEvent=t,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=t(this.emitter.fire,this.emitter))},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.inputEventListener.dispose(),this.emitter.dispose()}}();!function(t){t[t.Auto=1]="Auto",t[t.Hidden=2]="Hidden",t[t.Visible=3]="Visible"}(we||(we={}));var xe,Re=function(){function t(t,e,n,i,o,r){e|=0,n|=0,i|=0,o|=0,r|=0,(t|=0)<0&&(t=0),n+t>e&&(n=e-t),n<0&&(n=0),i<0&&(i=0),r+i>o&&(r=o-i),r<0&&(r=0),this.width=t,this.scrollWidth=e,this.scrollLeft=n,this.height=i,this.scrollHeight=o,this.scrollTop=r}return t.prototype.equals=function(t){return this.width===t.width&&this.scrollWidth===t.scrollWidth&&this.scrollLeft===t.scrollLeft&&this.height===t.height&&this.scrollHeight===t.scrollHeight&&this.scrollTop===t.scrollTop},t.prototype.withScrollDimensions=function(e){return new t(void 0!==e.width?e.width:this.width,void 0!==e.scrollWidth?e.scrollWidth:this.scrollWidth,this.scrollLeft,void 0!==e.height?e.height:this.height,void 0!==e.scrollHeight?e.scrollHeight:this.scrollHeight,this.scrollTop)},t.prototype.withScrollPosition=function(e){return new t(this.width,this.scrollWidth,void 0!==e.scrollLeft?e.scrollLeft:this.scrollLeft,this.height,this.scrollHeight,void 0!==e.scrollTop?e.scrollTop:this.scrollTop)},t.prototype.createScrollEvent=function(t){var e=this.width!==t.width,n=this.scrollWidth!==t.scrollWidth,i=this.scrollLeft!==t.scrollLeft,o=this.height!==t.height,r=this.scrollHeight!==t.scrollHeight,s=this.scrollTop!==t.scrollTop;return{width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:e,scrollWidthChanged:n,scrollLeftChanged:i,heightChanged:o,scrollHeightChanged:r,scrollTopChanged:s}},t}(),Ee=function(e){function n(t,n){var i=e.call(this)||this;return i._onScroll=i._register(new Ce),i.onScroll=i._onScroll.event,i._smoothScrollDuration=t,i._scheduleAtNextAnimationFrame=n,i._state=new Re(0,0,0,0,0,0),i._smoothScrolling=null,i}return t(n,e),n.prototype.dispose=function(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),e.prototype.dispose.call(this)},n.prototype.setSmoothScrollDuration=function(t){this._smoothScrollDuration=t},n.prototype.validateScrollPosition=function(t){return this._state.withScrollPosition(t)},n.prototype.getScrollDimensions=function(){return this._state},n.prototype.setScrollDimensions=function(t){var e=this._state.withScrollDimensions(t);this._setState(e),this._smoothScrolling&&this._smoothScrolling.acceptScrollDimensions(this._state)},n.prototype.getFutureScrollPosition=function(){return this._smoothScrolling?this._smoothScrolling.to:this._state},n.prototype.getCurrentScrollPosition=function(){return this._state},n.prototype.setScrollPositionNow=function(t){var e=this._state.withScrollPosition(t);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(e)},n.prototype.setScrollPositionSmooth=function(t){var e=this;if(0===this._smoothScrollDuration)return this.setScrollPositionNow(t);if(this._smoothScrolling){t={scrollLeft:void 0===t.scrollLeft?this._smoothScrolling.to.scrollLeft:t.scrollLeft,scrollTop:void 0===t.scrollTop?this._smoothScrolling.to.scrollTop:t.scrollTop};i=this._state.withScrollPosition(t);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;var n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration);this._smoothScrolling.dispose(),this._smoothScrolling=n}else{var i=this._state.withScrollPosition(t);this._smoothScrolling=Ae.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(function(){e._smoothScrolling&&(e._smoothScrolling.animationFrameDisposable=null,e._performSmoothScrolling())})},n.prototype._performSmoothScrolling=function(){var t=this;if(this._smoothScrolling){var e=this._smoothScrolling.tick(),n=this._state.withScrollPosition(e);if(this._setState(n),e.isDone)return this._smoothScrolling.dispose(),void(this._smoothScrolling=null);this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(function(){t._smoothScrolling&&(t._smoothScrolling.animationFrameDisposable=null,t._performSmoothScrolling())})}},n.prototype._setState=function(t){var e=this._state;e.equals(t)||(this._state=t,this._onScroll.fire(this._state.createScrollEvent(e)))},n}(Ut),De=function(){function t(t,e,n){this.scrollLeft=t,this.scrollTop=e,this.isDone=n}return t}(),Ae=function(){function t(t,e,n,i){this.from=t,this.to=e,this.duration=i,this._startTime=n,this.animationFrameDisposable=null,this._initAnimations()}return t.prototype._initAnimations=function(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)},t.prototype._initAnimation=function(t,e,n){if(Math.abs(t-e)>2.5*n){var i=void 0,o=void 0;return t<e?(i=t+.75*n,o=e-.75*n):(i=t-.75*n,o=e+.75*n),R(x(t,i),x(o,e),.33)}return x(t,e)},t.prototype.dispose=function(){null!==this.animationFrameDisposable&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)},t.prototype.acceptScrollDimensions=function(t){this.to=t.withScrollPosition(this.to),this._initAnimations()},t.prototype.tick=function(){return this._tick(Date.now())},t.prototype._tick=function(t){var e=(t-this._startTime)/this.duration;if(e<1){var n=this.scrollLeft(e),i=this.scrollTop(e);return new De(n,i,!1)}return new De(this.to.scrollLeft,this.to.scrollTop,!0)},t.prototype.combine=function(e,n,i){return t.start(e,n,i)},t.start=function(e,n,i){return i+=10,new t(e,n,Date.now()-10,i)},t}(),Me=function(){function t(t,e,n){this.timestamp=t,this.deltaX=e,this.deltaY=n,this.score=0}return t}(),Le=function(){function t(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}return t.prototype.isPhysicalMouseWheel=function(){if(-1===this._front&&-1===this._rear)return!1;for(var t=1,e=0,n=1,i=this._rear;;){var o=i===this._front?t:Math.pow(2,-n);if(t-=o,e+=this._memory[i].score*o,i===this._front)break;i=(this._capacity+i-1)%this._capacity,n++}return e<=.5},t.prototype.accept=function(t,e,n){var i=new Me(t,e,n);i.score=this._computeScore(i),-1===this._front&&-1===this._rear?(this._memory[0]=i,this._front=0,this._rear=0):(this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=i)},t.prototype._computeScore=function(t){if(Math.abs(t.deltaX)>0&&Math.abs(t.deltaY)>0)return 1;var e=.5;-1===this._front&&-1===this._rear||this._memory[this._rear];return(Math.abs(t.deltaX-Math.round(t.deltaX))>0||Math.abs(t.deltaY-Math.round(t.deltaY))>0)&&(e+=.25),Math.min(Math.max(e,0),1)},t.INSTANCE=new t,t}(),Oe=function(e){function n(t,n,i){var o=e.call(this)||this;o._onScroll=o._register(new Ce),o.onScroll=o._onScroll.event,t.style.overflow="hidden",o._options=A(n),o._scrollable=i,o._register(o._scrollable.onScroll(function(t){o._onDidScroll(t),o._onScroll.fire(t)}));var r={onMouseWheel:function(t){return o._onMouseWheel(t)},onDragStart:function(){return o._onDragStart()},onDragEnd:function(){return o._onDragEnd()}};return o._verticalScrollbar=o._register(new _e(o._scrollable,o._options,r)),o._horizontalScrollbar=o._register(new me(o._scrollable,o._options,r)),o._domNode=document.createElement("div"),o._domNode.className="nila-scrollable-element "+o._options.className,o._domNode.setAttribute("role","presentation"),o._domNode.style.position="relative",o._domNode.style.overflow="hidden",o._domNode.appendChild(t),o._domNode.appendChild(o._horizontalScrollbar.domNode.domNode),o._domNode.appendChild(o._verticalScrollbar.domNode.domNode),o._listenOnDomNode=o._options.listenOnDomNode||o._domNode,o._mouseWheelToDispose=[],o._setListeningToMouseWheel(o._options.handleMouseWheel),o.onmouseover(o._listenOnDomNode,function(t){return o._onMouseOver(t)}),o.onnonbubblingmouseout(o._listenOnDomNode,function(t){return o._onMouseOut(t)}),o._hideTimeout=o._register(new Gt),o._isDragging=!1,o._mouseIsOver=!1,o._shouldRender=!0,o._revealOnScroll=!0,o}return t(n,e),n.prototype.dispose=function(){this._mouseWheelToDispose=r(this._mouseWheelToDispose),e.prototype.dispose.call(this)},n.prototype.getDomNode=function(){return this._domNode},n.prototype.delegateVerticalScrollbarMouseDown=function(t){this._verticalScrollbar.delegateMouseDown(t)},n.prototype.getScrollDimensions=function(){return this._scrollable.getScrollDimensions()},n.prototype.setScrollDimensions=function(t){this._scrollable.setScrollDimensions(t)},n.prototype.updateClassName=function(t){this._options.className=t,It&&(this._options.className+=" mac"),this._domNode.className="nila-scrollable-element "+this._options.className},n.prototype.updateOptions=function(t){var e=A(t);this._options.handleMouseWheel=e.handleMouseWheel,this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity,this._options.fastScrollSensitivity=e.fastScrollSensitivity,this._setListeningToMouseWheel(this._options.handleMouseWheel),this._options.lazyRender||this._render()},n.prototype.setRevealOnScroll=function(t){this._revealOnScroll=t},n.prototype._setListeningToMouseWheel=function(t){var e=this;if(this._mouseWheelToDispose.length>0!==t&&(this._mouseWheelToDispose=r(this._mouseWheelToDispose),t)){var n=function(t){e._onMouseWheel(new jt(t))};this._mouseWheelToDispose.push(a(this._listenOnDomNode,he.WHEEL,n))}},n.prototype._onMouseWheel=function(t){var e,n=Le.INSTANCE;if(n.accept(Date.now(),t.deltaX,t.deltaY),t.deltaY||t.deltaX){var i=t.deltaY*this._options.mouseWheelScrollSensitivity,o=t.deltaX*this._options.mouseWheelScrollSensitivity;this._options.flipAxes&&(i=(e=[o,i])[0],o=e[1]);var r=!It&&t.browserEvent&&t.browserEvent.shiftKey;!this._options.scrollYToX&&!r||o||(o=i,i=0),t.browserEvent&&t.browserEvent.altKey&&(o*=this._options.fastScrollSensitivity,i*=this._options.fastScrollSensitivity);var s=this._scrollable.getFutureScrollPosition(),l={};if(i){var h=s.scrollTop-50*i;this._verticalScrollbar.writeScrollPosition(l,h)}if(o){var u=s.scrollLeft-50*o;this._horizontalScrollbar.writeScrollPosition(l,u)}l=this._scrollable.validateScrollPosition(l),s.scrollLeft===l.scrollLeft&&s.scrollTop===l.scrollTop||(this._options.mouseWheelSmoothScroll&&n.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(l):this._scrollable.setScrollPositionNow(l),this._shouldRender=!0)}(this._options.alwaysConsumeMouseWheel||this._shouldRender)&&(t.preventDefault(),t.stopPropagation())},n.prototype._onDidScroll=function(t){this._shouldRender=this._horizontalScrollbar.onDidScroll(t)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(t)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()},n.prototype.renderNow=function(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()},n.prototype._render=function(){this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render())},n.prototype._onDragStart=function(){this._isDragging=!0,this._reveal()},n.prototype._onDragEnd=function(){this._isDragging=!1,this._hide()},n.prototype._onMouseOut=function(t){this._mouseIsOver=!1,this._hide()},n.prototype._onMouseOver=function(t){this._mouseIsOver=!0,this._reveal()},n.prototype._reveal=function(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()},n.prototype._hide=function(){this._mouseIsOver||this._isDragging||(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())},n.prototype._scheduleHide=function(){var t=this;this._mouseIsOver||this._isDragging||this._hideTimeout.cancelAndSet(function(){return t._hide()},500)},n}(de),Pe=function(e){function n(t,n){var i=this;(n=n||{}).mouseWheelSmoothScroll=!1;var o=new Ee(0,function(t){return Ht(t)});return(i=e.call(this,t,n,o)||this)._register(o),i}return t(n,e),n.prototype.setScrollPosition=function(t){this._scrollable.setScrollPositionNow(t)},n.prototype.getScrollPosition=function(){return this._scrollable.getCurrentScrollPosition()},n}(Oe);(function(e){function n(t,n,i){return e.call(this,t,n,i)||this}t(n,e)})(Oe),function(e){function n(t,n){var i=e.call(this,t,n)||this;return i._element=t,i.onScroll(function(t){t.scrollTopChanged&&(i._element.scrollTop=t.scrollTop),t.scrollLeftChanged&&(i._element.scrollLeft=t.scrollLeft)}),i.scanDomNode(),i}t(n,e),n.prototype.scanDomNode=function(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}(Pe);!function(t){t.number="number",t.string="string",t.undefined="undefined",t.object="object",t.function="function",t.null="null",t.class="class",t.boolean="boolean",t.symbol="symbol",t.array="array"}(xe||(xe={}));xe.boolean,xe.number,xe.string,xe.function,xe.symbol,xe.array;var ze=function(){function t(t,e,n,i){this.mounted=!1,this.host=t;var o=document.createElement("div");o.className="nila-grid-header-cell",o.innerText=n.name,this.width=n.width,o.style.width=this.width+"px",this.left=i,this.right=this.left+this.width,this.domNode=o}return t.prototype.mount=function(t){this.mounted=!0,t&&t.mounted?this.host.insertBefore(this.domNode,t.domNode):this.host.appendChild(this.domNode)},t.prototype.unmount=function(){this.mounted=!1,this.host.removeChild(this.domNode)},t.prototype.dispose=function(){this.mounted=!1,this.domNode.remove()},t}(),Te=function(){function t(t){this.ctx=t,this.cellCache=Object.create(null),this.lastRenderLeft=0,this.lastRenderWidth=0;var e=document.createElement("div");Qt(e,"nila-grid-header"),this.domNode=e,this.ctx.options.showHeaderRow?this.ctx.options.headerRowHeight&&(this.domNode.style.height=this.ctx.options.headerRowHeight+"px"):(this.domNode.style.visibility="hidden",this.domNode.style.display="none")}return t.prototype.render=function(t,e){if(!e)return{mounted:[],margin:0};var n,i,o=t,r=t+e,s=this.lastRenderLeft+this.lastRenderWidth;for(n=this.indexAfter(r)-1,i=this.indexAt(Math.max(s,o));n>=i;n--)this.mountCell(n);for(n=Math.min(this.indexAt(this.lastRenderLeft),this.indexAfter(r))-1,i=this.indexAt(o);n>=i;n--)this.mountCell(n);for(n=this.indexAt(this.lastRenderLeft),i=Math.min(this.indexAt(o),this.indexAfter(s));n<i;n++)this.unmountCell(n);for(n=Math.max(this.indexAfter(r),this.indexAt(this.lastRenderLeft)),i=this.indexAfter(s);n<i;n++)this.unmountCell(n);var l=this.indexAt(o),h=this.cellCache[l],u=M(h.left-o,h.width,-h.width);return this.domNode.style.left=u+"px",this.lastRenderLeft=o,this.lastRenderWidth=r-o,{mounted:Object.keys(this.cellCache),margin:u}},t.prototype.mountTo=function(t){var e=g(t);t.appendChild(this.domNode),this.render(0,e)},t.prototype.invalidate=function(){var t=this;Object.keys(this.cellCache).forEach(function(e){t.unmountCell(e)}),this.cellCache=Object.create(null),this.lastRenderWidth=0,this.lastRenderWidth=0},t.prototype.getItemLeft=function(t){if(0===t)return 0;for(var e=0,n=0;n<t;n++)e+=this.ctx.columns[n].width;return e},t.prototype.mountCell=function(t){var e=this.cellCache[t];return e||(e=new ze(this.domNode,t,this.ctx.columns[t],this.getItemLeft(t)),this.cellCache[t]=e),!e.mounted&&(this.ctx.options.showHeaderRow&&e.mount(this.cellCache[t+1]),!0)},t.prototype.unmountCell=function(t){var e=this.cellCache[t];return e&&(e.dispose(),delete this.cellCache[t]),!0},t.prototype.indexAt=function(t){for(var e,n=0,i=this.ctx.columns.length-1;n<i;){e=Math.floor((n+i)/2);var o=this.getItemLeft(e);if(t<o)i=e;else{if(!(t>=o+this.ctx.columns[e].width))return e;if(n===e)break;n=e}}return this.ctx.columns.length-1},t.prototype.indexAfter=function(t){return Math.min(this.indexAt(t)+1,this.ctx.columns.length)},t.prototype.dispose=function(){this.domNode.remove()},t}(),ke=function(){function t(t,e,n){this.model=t,this.columns=e,this.options=n}return t}(),We={component:null,mountID:1,sandbox:!0,rootComponents:{},rootInstances:{}};const Ie={key:!0,ref:!0},He=t=>setTimeout(t,0),Fe=t=>{const e=void 0===window.setImmediate?He:window.setImmediate;e(t)},je=t=>setTimeout(t,99),Ue=t=>{const e=void 0===window.requestIdleCallback?je:window.requestIdleCallback;e(t)},Be=/^on[A-Z]/,Ve="http://www.w3.org/2000/svg",Ge="object"==typeof document&&"textContent"in document?"textContent":"nodeValue",Xe={tagNamePrefix:"",eventRegistry:{},createBody(){return document.body},createComment(t){return document.createComment(t)},createEmpty(){return this.createComment(" empty ")},createText(t){return document.createTextNode(t)},updateText(t,e){t[Ge]=e},isSVGMode:!1,createElement(t){const e=t._internal._parent;this.isSVGMode="svg"===t.type||e&&e.namespaceURI===Ve;let n;if(this.isSVGMode)n=document.createElementNS(Ve,t.type);else if(this.tagNamePrefix){let e="function"==typeof this.tagNamePrefix?this.tagNamePrefix(t.type):this.tagNamePrefix;n=document.createElement(e+t.type)}else n=document.createElement(t.type);let i=t.props;return this.setNativeProps(n,i),n},appendChild(t,e){return e.appendChild(t)},removeChild(t,e){(e=e||t.parentNode)&&e.removeChild(t)},replaceChild(t,e,n){(n=n||e.parentNode).replaceChild(t,e)},insertAfter(t,e,n){n=n||e.parentNode;const i=e.nextSibling;i?n.insertBefore(t,i):n.appendChild(t)},insertBefore(t,e,n){(n=n||e.parentNode).insertBefore(t,e)},addEventListener(t,e,n,i){return this.eventRegistry[e]?this.eventRegistry[e]("addEvent",t,e,n,i):t.addEventListener(e,n)},removeEventListener(t,e,n,i){return this.eventRegistry[e]?this.eventRegistry[e]("removeEvent",t,e,n,i):t.removeEventListener(e,n)},removeAllEventListeners(t){},removeAttribute(t,e){if("dangerouslySetInnerHTML"===e)return t.innerHTML=null;if("className"===e&&(e="class"),e in t)try{t[e]=null}catch(t){}t.removeAttribute(e)},setAttribute(t,e,n){if("dangerouslySetInnerHTML"===e)return t.innerHTML=n.__html;if("className"===e&&(e="class"),e in t)try{t[e]=n}catch(i){t.setAttribute(e,n)}else t.setAttribute(e,n)},setStyles(t,e){let n={};for(let e in n){const i=n[e];if(Array.isArray(i))for(let n=0;n<i.length;n++)t.style[e]=i[n];else t.style[e]=i}},setNativeProps(t,e){for(let n in e){let i=e[n];if("children"!==n&&null!=i)if("style"===n)this.setStyles(t,i);else if(Be.test(n)){let e=n.slice(2).toLowerCase();this.addEventListener(t,e,i)}else this.setAttribute(t,n,i)}}};class Ye{constructor(){this._currentElement=null}mountComponent(t,e,n,i){this._parent=t,this._parentInstance=e,this._context=n;let o={_internal:this},r=this.getNativeNode();return i?i(r,t):Xe.appendChild(r,t),o}unmountComponent(t){this._nativeNode&&!t&&Xe.removeChild(this._nativeNode,this._parent),this._nativeNode=null,this._parent=null,this._parentInstance=null,this._context=null}updateComponent(){}getNativeNode(){return null==this._nativeNode&&(this._nativeNode=Xe.createEmpty()),this._nativeNode}}var Ke={update(t,e,n){let i=t&&t.ref||null,o=e&&e.ref||null;i!==o&&(null!=i&&this.detach(t._owner,i,n),null!=o&&this.attach(e._owner,o,n))},attach(t,e,n){if(!t)throw new Error("You might be adding a ref to a component that was not created inside a component's `render` method, or you have multiple copies of Rax loaded.");let i=n.getPublicInstance();"function"==typeof e?e(i):"object"==typeof e?e.current=i:t._instance.refs[e]=i},detach(t,e,n){if("function"==typeof e)e(null);else{let i=n.getPublicInstance();"object"==typeof e&&e.current===i?e.current=null:t._instance.refs[e]===i&&delete t._instance.refs[e]}}},Qe=(t,e,n)=>{const i=e&&e.key;const o="string"==typeof i;const r="."+n.toString(36);if(o){let e="$"+i,n=void 0===t[e];return n||console.warn(`Encountered two children with the same key "${i}".`),n?e:r}return r};const $e=/^on[A-Z]/;class qe{constructor(t){this._currentElement=t}mountComponent(t,e,n,i){this._parent=t,this._parentInstance=e,this._context=n,this._mountID=We.mountID++;let o=this._currentElement.props,r={_internal:this,type:this._currentElement.type,props:o},s=o.append;this._instance=r,this._prevStyleCopy=Object.assign({},o.style);let l=this.getNativeNode();"tree"!==s&&(i?i(l,t):Xe.appendChild(l,t)),this._currentElement&&this._currentElement.ref&&Ke.attach(this._currentElement._owner,this._currentElement.ref,this);let h=o.children;return null!=h&&this.mountChildren(h,n),"tree"===s&&(i?i(l,t):Xe.appendChild(l,t)),r}mountChildren(t,e){Array.isArray(t)||(t=[t]);let n=this._renderedChildren={};return t.map((t,i)=>{let o=tt(t);let r=Qe(n,t,i);n[r]=o;o._mountIndex=i;let s=o.mountComponent(this.getNativeNode(),this._instance,e,null);return s})}unmountChildren(t){let e=this._renderedChildren;if(e){for(let n in e){let i=e[n];i.unmountComponent(t)}this._renderedChildren=null}}unmountComponent(t){if(this._nativeNode){let e=this._currentElement.ref;e&&Ke.detach(this._currentElement._owner,e,this),un.remove(this._nativeNode),t||Xe.removeChild(this._nativeNode,this._parent),Xe.removeAllEventListeners(this._nativeNode)}this.unmountChildren(t),this._currentElement=null,this._nativeNode=null,this._parent=null,this._parentInstance=null,this._context=null,this._instance=null,this._prevStyleCopy=null}updateComponent(t,e,n,i){this._currentElement=e,Ke.update(t,e,this);let o=t.props,r=e.props;this.updateProperties(o,r),this.updateChildren(r.children,i)}updateProperties(t,e){let n,i,o;for(n in t)if("children"!==n&&!e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&null!=t[n])if("style"===n){let t=this._prevStyleCopy;for(i in t)t.hasOwnProperty(i)&&((o=o||{})[i]="");this._prevStyleCopy=null}else $e.test(n)?"function"==typeof t[n]&&Xe.removeEventListener(this.getNativeNode(),n.slice(2).toLowerCase(),t[n]):Xe.removeAttribute(this.getNativeNode(),n,t[n]);for(n in e){let r=e[n],s="style"===n?this._prevStyleCopy:null!=t?t[n]:void 0;if("children"!==n&&e.hasOwnProperty(n)&&r!==s&&(null!=r||null!=s))if("style"===n)if(r?r=this._prevStyleCopy=Object.assign({},r):this._prevStyleCopy=null,null!=s){for(i in s)!s.hasOwnProperty(i)||r&&r.hasOwnProperty(i)||((o=o||{})[i]="");for(i in r)r.hasOwnProperty(i)&&s[i]!==r[i]&&((o=o||{})[i]=r[i])}else o=r;else if($e.test(n)){let t=n.slice(2).toLowerCase();"function"==typeof s&&Xe.removeEventListener(this.getNativeNode(),t,s,e),"function"==typeof r&&Xe.addEventListener(this.getNativeNode(),t,r,e)}else null!=r?Xe.setAttribute(this.getNativeNode(),n,r):Xe.removeAttribute(this.getNativeNode(),n,t[n])}o&&Xe.setStyles(this.getNativeNode(),o)}updateChildren(t,e){let n=this._renderedChildren;if(null!=t||null!=n){let i={},o={};if(null!=t){Array.isArray(t)||(t=[t]);for(let r=0,s=t.length;r<s;r++){let s=t[r],l=Qe(i,s,r),h=n&&n[l],u=h&&h._currentElement,a=h&&h._context;if(null!=h&&Y(u,s))u===s&&a===e||h.updateComponent(u,s,e,e),i[l]=h;else{if(h){let t=h.getNativeNode();h.unmountComponent(!0),o[l]=t}i[l]=tt(s)}}}let r,s;if(null!=n)for(let t in n)if(n.hasOwnProperty(t)){let e=n[t],o=!i[t];r?o&&e.unmountComponent():(r=e,s=o)}if(null!=i){let t=0,s=0,l=null,h=[];for(let u in i)if(i.hasOwnProperty(u)){let a=i[u],c=n&&n[u];if(c===a){let e=c.getNativeNode();if(Array.isArray(e)||(e=[e]),c._mountIndex<t){Array.isArray(l)&&(l=l[l.length-1]);for(let t=e.length-1;t>=0;t--)Xe.insertAfter(e[t],l)}h=h.concat(e),t=Math.max(c._mountIndex,t),c._mountIndex=s}else{null!=c&&(t=Math.max(c._mountIndex,t));let n=this.getNativeNode();Array.isArray(n)&&(n=this._parent),a.mountComponent(n,this._instance,e,(e,n)=>{function i(t){Array.isArray(l)&&(l=l[l.length-1]);let e;if(r&&!l&&(e=r.getNativeNode(),Array.isArray(e)&&(e=e[0])),l)for(let e=t.length-1;e>=0;e--)Xe.insertAfter(t[e],l);else if(e)for(let n=0;n<t.length;n++)Xe.insertBefore(t[n],e);else for(let e=0;e<t.length;e++)Xe.appendChild(t[e],n)}let s=o[u];Array.isArray(e)||(e=[e]);if(s)if(Array.isArray(s)||(s=[s]),c._mountIndex<t){for(let t=0;t<s.length;t++)Xe.removeChild(s[t]);i(e)}else{let t;for(let n=0;n<e.length;n++){let i=e[n];s[n]?Xe.replaceChild(i,s[n]):Xe.insertAfter(i,t),t=i}if(e.length<s.length)for(let t=e.length;t<s.length;t++)Xe.removeChild(s[t])}else i(e);h=h.concat(e)}),a._mountIndex=s}s++,l=a.getNativeNode()}if(Array.isArray(this._nativeNode)){this._nativeNode.splice(0,this._nativeNode.length);for(let t=0;t<h.length;t++)this._nativeNode.push(h[t])}}s&&r.unmountComponent(),this._renderedChildren=i}}getNativeNode(){return null==this._nativeNode&&(this._nativeNode=Xe.createElement(this._instance),un.set(this._nativeNode,this._instance)),this._nativeNode}getPublicInstance(){return this.getNativeNode()}getName(){return this._currentElement.type}}class Ze extends qe{constructor(t){super(t)}mountComponent(t,e,n,i){this._parent=t,this._parentInstance=e,this._context=n,this._mountID=We.mountID++;let o={_internal:this};this._instance=o;let r=this.getNativeNode(),s=this._currentElement;if(this.mountChildren(s,n),i)i(r,t);else for(let e=0;e<r.length;e++){let n=r[e];Xe.appendChild(n,t)}return o}mountChildren(t,e){let n=this._renderedChildren={},i=this.getNativeNode();return t.map((t,o)=>{let r=tt(t);let s=Qe(n,t,o);n[s]=r;r._mountIndex=o;let l=r.mountComponent(this._parent,this._instance,e,t=>{if(Array.isArray(t))for(let e=0;e<t.length;e++)i.push(t[e]);else i.push(t)});return l})}unmountComponent(t){if(this._nativeNode&&(un.remove(this._nativeNode),!t))for(let t=0;t<this._nativeNode.length;t++)Xe.removeChild(this._nativeNode[t]);this.unmountChildren(!0),this._currentElement=null,this._nativeNode=null,this._parent=null,this._parentInstance=null,this._context=null,this._instance=null}updateComponent(t,e,n,i){this._currentElement=e,this.updateChildren(this._currentElement,i)}getNativeNode(){return null==this._nativeNode&&(this._nativeNode=[]),this._nativeNode}getPublicInstance(){return this.getNativeNode()}getName(){return"fragment"}}class Je{constructor(t,e,n){this.props=t,this.context=e,this.refs={},this.updater=n}isComponentClass(){}setState(t,e){this.updater.setState(this,t,e)}forceUpdate(t){this.updater.forceUpdate(this,t)}}class tn extends Je{constructor(t,e){super(),this.pureRender=t,this.hooksIndex=0,this.hooks={},this.didMountHandlers=[],this.didUpdateHandlers=[],this.willUnmountHandlers=[],t.forwardRef&&(this.prevForwardRef=this.forwardRef=e);const n=t.compares;n&&(this.shouldComponentUpdate=(t=>{let e=!0;for(let i=n.length-1;i>-1&&!(e=n[i](this.props,t));i--);return!e||this.prevForwardRef!==this.forwardRef}))}getCurrentHookId(){return++this.hooksIndex}readContext(t){const e=t.Provider,n=this._internal._context[e.contextProp];if(n){const t=this._internal._mountID;if(!n[t]){n[t]={};const e=e=>{e!==n[t].renderedContext&&this.update()};n.on(e),this.willUnmountHandlers.push(()=>{delete n[t];n.off(e)})}return n[t].renderedContext=n.value}return e.defaultValue}isComponentRendered(){return Boolean(this._internal._renderedComponent)}componentDidMount(){this.didMountHandlers.forEach(t=>t())}componentDidUpdate(){this.didUpdateHandlers.forEach(t=>t())}componentWillUnmount(){this.willUnmountHandlers.forEach(t=>t())}update(){Fe(()=>this.forceUpdate())}render(){return this.hooksIndex=0,this.pureRender(this.props,this.forwardRef?this.forwardRef:this.context)}}const en={setState:function(t,e,n){let i=t._internal;i&&(Q(i,e),K(i,n),!i._pendingState&&i._renderedComponent&&this.runUpdate(t))},forceUpdate:function(t,e){let n=t._internal;n&&(n._pendingForceUpdate=!0,K(n,e),n._renderedComponent&&this.runUpdate(t))},runUpdate:function(t){let e=t._internal,n=e._pendingCallbacks;e._pendingCallbacks=null;let i=e._currentElement,o=e._context;(e._pendingStateQueue||e._pendingForceUpdate)&&e.updateComponent(i,i,o,o),this.runCallbacks(n,t)},runCallbacks(t,e){if(t)for(let n=0;n<t.length;n++)t[n].call(e)}},nn=Object.prototype.hasOwnProperty;class on{constructor(t){this._currentElement=t}getName(){let t=this._currentElement.type,e=this._instance&&this._instance.constructor;return t.displayName||e&&e.displayName||t.name||e&&e.name||null}mountComponent(t,e,n,i){this._parent=t,this._parentInstance=e,this._context=n,this._mountID=We.mountID++,this._updateCount=0;let o,r,s=this._currentElement,l=s.type,h=s.ref,u=s.props,a=l.prototype,c=a&&l.prototype.isComponentClass,d=a&&l.prototype.render,p=this._processContext(n);try{if(c||d)o=new l(u,p,en);else{if("function"!=typeof l)throw new Error(`Invalid component type: ${l}. (current: ${"object"==typeof l&&Object.keys(l)||typeof l})`);o=new tn(l,h)}}catch(t){return J(e,t),o}o.props=u,o.context=p,o.refs={},o.updater=en,o._internal=this,this._instance=o;let f=o.state;void 0===f&&(o.state=f=null);let m=null,_=t=>{m=t};o.componentWillMount&&Z(()=>{o.componentWillMount()},o,_),null==r&&(We.component=this,o.state=this._processPendingState(u,p),Z(()=>{r=o.render()},o,_),We.component=null),this._renderedComponent=tt(r),this._renderedComponent.mountComponent(this._parent,o,this._processChildContext(n),i),m&&J(o,m),!this._currentElement.type.forwardRef&&h&&Ke.attach(s._owner,h,this),o.componentDidMount&&Z(()=>{o.componentDidMount()},o);let g=this._pendingCallbacks;return g&&(this._pendingCallbacks=null,en.runCallbacks(g,o)),o}unmountComponent(t){let e=this._instance;if(e){if(e.componentWillUnmount&&Z(()=>{e.componentWillUnmount()},e),e._internal=null,null!=this._renderedComponent){let e=this._currentElement.ref;!this._currentElement.type.forwardRef&&e&&Ke.detach(this._currentElement._owner,e,this),this._renderedComponent.unmountComponent(t),this._renderedComponent=null,this._instance=null}this._currentElement=null,this._parentInstance=null,this._pendingStateQueue=null,this._pendingForceUpdate=!1,this._context=null}}_processContext(t){let e=this._currentElement.type.contextTypes;if(!e)return{};let n={};for(let i in e)n[i]=t[i];return n}_processChildContext(t){let e=this._instance,n=e.getChildContext&&e.getChildContext();return n?Object.assign({},t,n):t}_processPendingState(t,e){let n=this._instance,i=this._pendingStateQueue;if(!i)return n.state;this._pendingStateQueue=null;let o=Object.assign({},n.state);for(let r=0;r<i.length;r++){let s=i[r];Object.assign(o,"function"==typeof s?s.call(n,o,t,e):s)}return o}updateComponent(t,e,n,i){let o=this._instance;o||console.error(`Update component '${this.getName()}' that has already been unmounted (or failed to mount).`);let r,s,l=!1;this._context===i?r=o.context:(r=this._processContext(i),l=!0),t===e?s=e.props:(s=e.props,l=!0),l&&o.componentWillReceiveProps&&(this._pendingState=!0,Z(()=>{o.componentWillReceiveProps(s,r)},o),this._pendingState=!1),this._currentElement.type.forwardRef?(o.prevForwardRef=t.ref,o.forwardRef=e.ref):Ke.update(t,e,this);let h=!0,u=o.props,a=o.state,c=this._processPendingState(s,r);if(this._pendingForceUpdate||(o.shouldComponentUpdate?h=Z(()=>o.shouldComponentUpdate(s,c,r),o):o.isPureComponentClass&&(h=!q(u,s)||!q(a,c))),h){this._pendingForceUpdate=!1;let t=o.context;Z(()=>{o.componentWillUpdate&&o.componentWillUpdate(s,c,r)},o),this._currentElement=e,this._context=i,o.props=s,o.state=c,o.context=r,this._updateRenderedComponent(i),Z(()=>{o.componentDidUpdate&&o.componentDidUpdate(u,a,t)},o),this._updateCount++}else this._currentElement=e,this._context=i,o.props=s,o.state=c,o.context=r;let d=this._pendingCallbacks;d&&(this._pendingCallbacks=null,en.runCallbacks(d,o))}_updateRenderedComponent(t){let e,n=this._renderedComponent,i=n._currentElement,o=this._instance;if(We.component=this,Z(()=>{e=o.render()},o),We.component=null,Y(i,e)){const o=n._context,r=this._processChildContext(t);i===e&&o===r||n.updateComponent(i,e,o,r)}else{let i=n.getNativeNode();n.unmountComponent(!0),this._renderedComponent=tt(e),this._renderedComponent.mountComponent(this._parent,o,this._processChildContext(t),(t,e)=>{Array.isArray(t)||(t=[t]);Array.isArray(i)||(i=[i]);let n;for(let o=0;o<t.length;o++){let r=t[o];i[o]?Xe.replaceChild(r,i[o]):n?Xe.insertAfter(r,n):Xe.appendChild(r,e),n=r}if(t.length<i.length)for(let e=t.length;e<i.length;e++)Xe.removeChild(i[e])})}}getNativeNode(){let t=this._renderedComponent;if(t)return t.getNativeNode()}getPublicInstance(){let t=this._instance;return t instanceof tn?null:t}}class rn{constructor(t){this._currentElement=t,this._stringText=String(t)}mountComponent(t,e,n,i){this._parent=t,this._parentInstance=e,this._context=n,this._mountID=We.mountID++;let o=this.getNativeNode();return i?i(o,t):Xe.appendChild(o,t),{_internal:this}}unmountComponent(t){this._nativeNode&&!t&&Xe.removeChild(this._nativeNode,this._parent),this._currentElement=null,this._nativeNode=null,this._parent=null,this._parentInstance=null,this._context=null,this._stringText=null}updateComponent(t,e,n){t!==e&&(this._currentElement=e,this._stringText=String(e),Xe.updateText(this.getNativeNode(),this._stringText))}getNativeNode(){return null==this._nativeNode&&(this._nativeNode=document.createTextNode(this._stringText)),this._nativeNode}}let sn=1;class ln extends Je{constructor(...t){super(...t),this.rootID=sn++}isRootComponent(){}render(){return this.props.children}getPublicInstance(){return this.getRenderedComponent().getPublicInstance()}getRenderedComponent(){return this._internal._renderedComponent}}const hn="$$instance";var un={set(t,e){t[hn]||(t[hn]=e,e.rootID&&(We.rootInstances[e.rootID]=e,We.rootComponents[e.rootID]=e._internal))},get(t){return t[hn]},remove(t){let e=this.get(t);e&&(t[hn]=null,e.rootID&&(delete We.rootComponents[e.rootID],delete We.rootInstances[e.rootID]))},mount(t,e,n){null==e&&(e=document.body);let i;if(n){let t=n._internal;i=t._processChildContext(t._context)}let o=this.get(e);if(o&&o.isRootComponent){let n=o.getRenderedComponent(),r=n._currentElement;if(Y(r,t)){let e=n._context,s=i||e;return r===t&&e===s||n.updateComponent(r,t,e,s),o}X(e)}let r=tt(F(ln,null,t)),s=i||{},l=r.mountComponent(e,null,s);return this.set(e,l),l}};const an={createElement:F,useEffect:B,useLayoutEffect:V},cn={unmountComponentAtNode:X,render:et};var dn,pn=function(){function t(t){this.group=t,this.aggregations=[]}return Object.defineProperty(t.prototype,"rows",{get:function(){return this.group.rows},enumerable:!0,configurable:!0}),t.prototype.store=function(t,e,n){this.aggregations.push({type:t,field:e,value:n})},t.prototype.getByField=function(t){return this.aggregations.find(function(e){return e.field===t})},t}(),fn=function(){function t(t){this.ds=t,this.rows=[],this._collapsed=!1}return Object.defineProperty(t.prototype,"collapsed",{get:function(){return this._collapsed},set:function(t){this._collapsed=t,t?this.ds.collapseGroup(this):this.ds.expandGroup(this)},enumerable:!0,configurable:!0}),t}();!function(t){t[t.none=0]="none",t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical",t[t.diagonal=4]="diagonal",t[t.all=7]="all"}(dn||(dn={}));var mn;!function(t){t.Add="add",t.Remove="remove"}(mn||(mn={}));var _n={fullUpdateThreshold:1e3,hasher:ft},gn=function(){function t(t){void 0===t&&(t={}),this.suspend=!1,this.hashes=[],this.items=[],this.rows=[],this.memorizedRows=[],this.collapsedGroups=[],this.sortingSettings=[],this._onRowsChanged=new Ce,this.toDispose=[],this.options=wt({},t,_n),this.toDispose.push(this._onRowsChanged)}return Object.defineProperty(t.prototype,"onRowsChanged",{get:function(){return this._onRowsChanged.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),t.prototype.getItem=function(t){return this.items[t]},t.prototype.getRow=function(t){return this.rows[t]},t.prototype.getItems=function(){return this.items.slice()},t.prototype.setItems=function(t){if(!L(t))throw new Error("Expect an array");this.suspend?this.items=t.slice():(this.memorizedRows=this.rows.slice(),this.items=t.slice(),this.refresh())},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n,i;this.suspend?(i=this.items).push.apply(i,t):(this.memorizedRows=this.rows.slice(),(n=this.items).push.apply(n,t),this.refresh())},t.prototype.pop=function(){this.suspend?this.items.pop():(this.memorizedRows=this.rows.slice(),this.items.pop(),this.refresh())},t.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n,i;this.suspend?(i=this.items).unshift.apply(i,t):(this.memorizedRows=this.rows.slice(),(n=this.items).unshift.apply(n,t),this.refresh())},t.prototype.shift=function(){this.suspend?this.items.shift():(this.memorizedRows=this.rows.slice(),this.items.shift(),this.refresh())},t.prototype.splice=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o,r;this.suspend?(r=this.items).splice.apply(r,[t,e].concat(n)):(this.memorizedRows=this.rows.slice(),(o=this.items).splice.apply(o,[t,e].concat(n)),this.refresh())},t.prototype.sort=function(t){if(this.suspend)return this.items.sort(t);this.memorizedRows=this.rows.slice();var e=this.items.sort(t);return this.refresh(),e},t.prototype.reverse=function(){this.suspend?this.items.reverse():(this.memorizedRows=this.rows.slice(),this.items.reverse(),this.refresh())},t.prototype.setGrouping=function(t){this.groupingSettings=[],this.collapsedGroups.length=0,L(t)&&t.length&&(this.groupingSettings=t.map(function(t,e){var n=Object.create(null);return n.accessor=mt(t.accessor),n.formatter=t.formatter||nt,n.comparer=t.comparer,n.level=e,n.aggregators=t.aggregators||[],n})),this.scheduleUpdate()},t.prototype.getGrouping=function(t){return z(t)?null:this.groupingSettings[t]},t.prototype.getGroupings=function(){return this.groupingSettings.slice()},t.prototype.setSorting=function(t){this.sortingSettings.length=0,t&&(this.sortingSettings=t.slice(),this.scheduleUpdate())},t.prototype.getSortingByField=function(t){return this.sortingSettings.find(function(e){return e.accessor===t})},t.prototype.beginUpdate=function(){this.suspend=!0,this.memorizedRows=this.rows.slice()},t.prototype.endUpdate=function(){this.suspend=!1,this.refresh()},t.prototype.collapseGroup=function(t){var e=t.$$hash;-1===this.collapsedGroups.indexOf(e)&&(this.collapsedGroups.push(e),this.scheduleUpdate())},t.prototype.expandGroup=function(t){var e=t.$$hash,n=this.collapsedGroups.indexOf(e);-1!==n&&(this.collapsedGroups.splice(n,1),this.scheduleUpdate())},t.prototype.scheduleUpdate=function(){var t=this;this.prevFrame&&cancelAnimationFrame&&cancelAnimationFrame(this.prevFrame),this.prevFrame=requestAnimationFrame(function(){return t.refresh()})},t.prototype.calulateDiff=function(t,e){var n=this,i=[];if(t.length>this.options.fullUpdateThreshold||e.length>this.options.fullUpdateThreshold)return this.hashes.length=0,t.length&&i.push({type:mn.Remove,oldPos:0,newPos:0,items:t}),e.length&&i.push({type:mn.Add,oldPos:t.length,newPos:0,items:e}),i;var o=e.map(function(t){return z(t.$$hash)?n.options.key?t[n.options.key]:ot(t):t.$$hash});return i=pt(this.hashes,o).map(function(i){return i.type===mn.Remove?wt({},i,{items:i.items.map(function(e){return t[n.hashes.indexOf(e)]})}):wt({},i,{items:i.items.map(function(t){return e[o.indexOf(t)]})})}),this.hashes=o,i},t.prototype.extractGroups=function(t,e){if(!e)return this.groupingSettings.length?this.extractGroups(t,this.groupingSettings[0]):[];for(var n=new Map,i=[],o=e.level,r=0,s=t.length;r<s;r++){var l=t[r],h=e.accessor(l);if(!(d=n.get(h))){var u="?grouping='"+ot(h)+"&level="+o,a=this.collapsedGroups.indexOf(u)>-1;(d=new fn(this)).$$hash=u,d.key=h,d.level=o,d._collapsed=a,n.set(h,d),i.push(d)}d.rows.push(l)}if(e.level<this.groupingSettings.length-1)for(var c=this.groupingSettings[e.level+1],r=0;r<i.length;r++){var d=i[r];d.subGroups=this.extractGroups(d.rows,c)}return i.sort(function(t,n){return e.comparer(t.key,n.key)}),i},t.prototype.flattenGroupedRows=function(t,e){void 0===e&&(e=0);for(var n=[],i=0,o=t.length;i<o;i++){var r=t[i];if(n.push(r),!r.collapsed){var s=void 0;s=r.subGroups?this.flattenGroupedRows(r.subGroups,e+1):this.sortRows(r.rows),n.push.apply(n,s)}r.totals&&!r.collapsed&&n.push(r.totals)}return n},t.prototype.sortRows=function(t){if(!this.sortingSettings.length)return t;var e=this.sortingSettings.slice();return t.slice().sort(function(t,n){for(var i,o=0,r=e.length;o<r;o++){var s=e[o],l=mt(s.accessor);if(0!==(i=s.comparer(l(t),l(n))))return i}return i})},t.prototype.calulateRows=function(t){if(L(this.groupingSettings)&&this.groupingSettings.length){for(var e=this.extractGroups(t),n=new Set,i=0,o=e.length;i<o;i++){var r=e[i],s=r.$$hash;r.collapsed||this.doAggregation(r),n.add(s)}if(this.collapsedGroups=this.collapsedGroups.filter(function(t){return n.has(t)}),e.length)return this.flattenGroupedRows(e)}return this.sortRows(t)},t.prototype.doAggregation=function(t){var e=new pn(t);e.$$hash=t+"&total=true",t.totals=e;for(var n=this.groupingSettings[t.level],i=0,o=n.aggregators.length;i<o;i++){var r=n.aggregators[i];e.store(r.type,r.field,r.accumulate(t.rows))}},t.prototype.refresh=function(){if(!this.suspend){this.rows=this.calulateRows(this.items);var t=this.calulateDiff(this.memorizedRows,this.rows);t.length&&this._onRowsChanged.fire(t)}},t.prototype.dispose=function(){r(this.toDispose),this.toDispose.length=0,this.memorizedRows.length=0,this.items.length=0,this.hashes.length=0,this.groupingSettings.length=0,this.sortingSettings.length=0},t}(),vn=function(){function t(t){if(this.items=[],t instanceof gn)this.ds=t;else{if(!L(t))throw new Error("Unsupport ds type");this.items=t.slice()}}return Object.defineProperty(t.prototype,"length",{get:function(){return this.ds?this.ds.length:this.items.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){return this.ds?this.ds.getRow(t):this.items[t]},t.prototype.getGrouping=function(t){return this.ds?this.ds.getGrouping(t):null},t}(),yn={explicitInitialization:!0,defaultColumnWidth:80,rowHeight:20,defaultFormatter:_t,showHeaderRow:!0,headerRowHeight:20},Sn={formatter:_t},wn=function(){function t(t,e){this.host=t,this.width=e,this.mounted=!1;var n=document.createElement("div");n.className="nila-grid-cell",n.style.width=this.width+"px",this.domNode=n}return t.prototype.mount=function(t){this.mounted=!0,t&&t.mounted?this.host.insertBefore(this.domNode,t.domNode):this.host.appendChild(this.domNode);var e=this.getComponent();e&&cn.render(e(),this.domNode)},t.prototype.unmount=function(){this.mounted=!1,cn.unmountComponentAtNode(this.domNode),this.host.removeChild(this.domNode)},t.prototype.dispose=function(){this.mounted=!1,cn.unmountComponentAtNode(this.domNode),this.domNode.remove()},t}(),bn=function(e){function n(t,n){var i=e.call(this,t,n)||this;return Qt(i.domNode,"empty-cell"),i}return t(n,e),n.prototype.getComponent=function(){return null},n}(wn),Nn=function(e){function n(t,n,i,o){var r=e.call(this,t,n)||this;return r.datum=i,r.col=o,r.value=i[o.field],r.formatter=o.formatter,Qt(r.domNode,"data-cell"),r}return t(n,e),n.prototype.getComponent=function(){return this.formatter(this.value,this.col,this.datum)},n}(wn),Cn=function(e){function n(t,n,i,o,r){var s=e.call(this,t,n)||this;return s.key=i,s.value=o,s.type=r,Qt(s.domNode,"aggregation-cell"),s}return t(n,e),n.prototype.getComponent=function(){return it(this.key,this.value,this.type)},n}(wn),xn=function(e){function n(t,n,i,o,r){var s=e.call(this,t,n)||this;return s.data=i,s.formatter=o,s.config=r,s.mounted=!1,Qt(s.domNode,"merged-cell"),s}return t(n,e),n.prototype.getComponent=function(){return this.formatter(this.data,this.config)},n}(wn),Rn=function(){function t(t,e){this.host=t,this.ctx=e,this.mounted=!1,this.prevSlibing=null,this.nextSlibing=null;var n=document.createElement("div");Qt(n,"nila-grid-row"),this.domNode=n,this.ctx.options.rowHeight&&(this.domNode.style.height=this.ctx.options.rowHeight+"px")}return t.prototype.mountBefore=function(t){void 0===t&&(t=null),this.nextSlibing=t,t?(t.prevSlibing=this,this.host.insertBefore(this.domNode,t.domNode)):this.host.appendChild(this.domNode),this.mounted=!0},t.prototype.mountAfter=function(t){this.prevSlibing=t,t.nextSlibing=this;var e=t.domNode.nextElementSibling;e?this.host.insertBefore(this.domNode,e):this.host.appendChild(this.domNode),this.mounted=!0},t.prototype.mount=function(){this.mounted=!0,this.host.appendChild(this.domNode)},t.prototype.unmount=function(){this.prevSlibing=null,this.nextSlibing=null,this.host.removeChild(this.domNode),this.mounted=!1},t.prototype.dispose=function(){this.mounted=!1,this.prevSlibing&&(this.prevSlibing.nextSlibing=this.nextSlibing),this.nextSlibing&&(this.nextSlibing.prevSlibing=this.prevSlibing),this.nextSlibing=null,this.prevSlibing=null,this.domNode.remove()},t}(),En=function(e){function n(t,n,i){var o=e.call(this,t,n)||this;return o.data=i,o.cellCache=Object.create(null),o}return t(n,e),n.prototype.mountCell=function(t){var e=this.cellCache[t];if(!e){var n=this.ctx.columns[t];e=new Nn(this.domNode,n.width,this.data,n),this.cellCache[t]=e}return!e.mounted&&(e.mount(this.cellCache[t+1]),!0)},n.prototype.unmountCell=function(t){var e=this.cellCache[t];return e&&(e.dispose(),delete this.cellCache[t]),!0},n.prototype.updateCell=function(t,e){for(var n=Object.keys(this.cellCache),i={},o=0,r=t.length;o<r;o++)i[t[o]]=!0,this.mountCell(parseInt(t[o]));for(var o=0,r=n.length;o<r;o++)i[n[o]]||this.unmountCell(parseInt(n[o]));this.domNode.style.left=e+"px"},n.prototype.invalidate=function(){var t=this;Object.keys(this.cellCache).forEach(function(e){t.unmountCell(e)}),this.cellCache=Object.create(null)},n.prototype.toString=function(){return JSON.stringify(this.data)},n.prototype.dispose=function(){var t=this;e.prototype.dispose.call(this),Object.keys(this.cellCache).forEach(function(e){t.cellCache[e].dispose(),delete t.cellCache[e]})},n}(Rn),Dn=function(e){function n(t,n,i){var o=e.call(this,t,n)||this;return o.group=i,o}return t(n,e),n.prototype.updateCell=function(t,e){if(!this.cell){var n=this.ctx.model.getGrouping(this.group.level);this.cell=new xn(this.domNode,-1,this.group,n.formatter,n),this.cell.mount()}this.domNode.style.left=e+"px"},n.prototype.invalidate=function(){this.cell&&(this.cell.dispose(),this.cell=null)},n}(Rn),An=function(e){function n(t,n,i){var o=e.call(this,t,n)||this;return o.groupTotals=i,o.cellCache=Object.create(null),o}return t(n,e),n.prototype.mountCell=function(t){var e=this.cellCache[t];if(!e){var n=this.ctx.columns[t],i=this.groupTotals.getByField(n.field);e=i?new Cn(this.domNode,n.width,i.field,i.value,i.type):new bn(this.domNode,n.width),this.cellCache[t]=e}return!e.mounted&&(e.mount(this.cellCache[t+1]),!0)},n.prototype.unmountCell=function(t){var e=this.cellCache[t];return e&&(e.dispose(),delete this.cellCache[t]),!0},n.prototype.updateCell=function(t,e){for(var n=Object.keys(this.cellCache),i={},o=0,r=t.length;o<r;o++)i[t[o]]=!0,this.mountCell(parseInt(t[o]));for(var o=0,r=n.length;o<r;o++)i[n[o]]||this.unmountCell(parseInt(n[o]));this.domNode.style.left=e+"px"},n.prototype.invalidate=function(){var t=this;Object.keys(this.cellCache).forEach(function(e){t.unmountCell(e)}),this.cellCache=Object.create(null)},n.prototype.dispose=function(){var t=this;e.prototype.dispose.call(this),Object.keys(this.cellCache).forEach(function(e){t.cellCache[e].dispose(),delete t.cellCache[e]})},n}(Rn),Mn=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.updateCell=function(t,e){},n.prototype.invalidate=function(){},n}(Rn),Ln=function(){function t(t,e,n,i){void 0===i&&(i={}),this.container=t,this.mountedRows=[],this.shouldShowHorizonalScrollbar=!1,this.shouldShowVerticalScrollbar=!1,this.viewEventRegistered=!1,this.toDispose=[],this.indexOfFirstMountedRow=-1,this.indexOfLastMountedRow=-1;var o=gt(i),r=new vn(e),s=vt(n,o.defaultColumnWidth,o.defaultFormatter);yt(s,t.clientWidth),this.ctx=new ke(r,s,o),this.createElement(t),this.ctx.options.explicitInitialization&&this.render(),e instanceof gn&&this.registerDataListeners(e)}return t.prototype.registerViewListeners=function(){var t=this;this.toDispose.push(this.scrollableElement.onScroll(function(e){(e.heightChanged||e.scrollHeightChanged||e.scrollTopChanged)&&t.renderVerticalChanges(e.height,e.scrollTop),(e.widthChanged||e.scrollWidthChanged||e.scrollLeftChanged)&&t.renderHorizonalChanges(e.width,e.scrollLeft)}))},t.prototype.registerDataListeners=function(t){var e=this;this.toDispose.push(t.onRowsChanged(function(t){-1===e.indexOfFirstMountedRow&&-1===e.indexOfLastMountedRow?(e.scrollHeight=e.getTotalRowsHeight(),e.renderHorizonalChanges(g(e.body))):e.handlePatchs(t)}))},t.prototype.render=function(){this.layout(),this.viewEventRegistered||this.registerViewListeners()},t.prototype.invalidate=function(){this.invalidateAllRows(),this.header.invalidate()},t.prototype.invalidateRow=function(t){t<this.indexOfFirstMountedRow||t>this.indexOfLastMountedRow||this.mountedRows[t-this.indexOfFirstMountedRow].invalidate()},t.prototype.invalidateRows=function(t){for(var e=0,n=t.length;e<n;e++)this.invalidateRow(t[e])},t.prototype.invalidateAllRows=function(){for(;this.mountedRows.length;)this.mountedRows.pop().dispose()},t.prototype.createElement=function(e){if(this.domNode=document.createElement("div"),this.domNode.className="nila-grid nila-grid-instance-"+t.counter++,this.header=new Te(this.ctx),this.body=document.createElement("div"),this.body.className="nila-grid-body",O(this.ctx.options.viewportClass)&&this.ctx.options.viewportClass.length){var n=this.ctx.options.viewportClass.split(/\s+/i);$t.apply(void 0,[this.body].concat(n))}this.scrollableElement=new Pe(this.body,{alwaysConsumeMouseWheel:!0,horizontal:3,vertical:3}),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="nila-grid-rows",this.body.appendChild(this.rowsContainer),e.appendChild(this.domNode),this.header.mountTo(this.domNode);var i=this.scrollableElement.getDomNode();this.domNode.appendChild(i);var o=this.ctx.options.showHeaderRow?this.ctx.options.headerRowHeight||v(this.header.domNode):0;i.style.height=v(this.domNode)-o+"px"},t.prototype.layout=function(t,e){var n=t||v(this.body);n>this.container.clientHeight&&(this.shouldShowVerticalScrollbar=!0),this.viewHeight=n,this.scrollHeight=this.getTotalRowsHeight()||0;var i=e||g(this.body);i>this.container.clientWidth&&(this.shouldShowHorizonalScrollbar=!0),this.viewWidth=i,this.scrollWidth=this.getContentWidth()||0,this.renderHeader(i),this.renderVerticalChanges(n),this.renderHorizonalChanges(i)},t.prototype.getTotalRowsHeight=function(){return this.ctx.model.length*this.ctx.options.rowHeight},t.prototype.getContentWidth=function(){return b(this.ctx.columns,"width")},Object.defineProperty(t.prototype,"viewHeight",{get:function(){return this.scrollableElement.getScrollDimensions().height},set:function(t){this.scrollableElement.setScrollDimensions({height:t})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollHeight",{set:function(t){this.scrollableElement.setScrollDimensions({scrollHeight:t+(this.shouldShowHorizonalScrollbar?10:0)})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewWidth",{get:function(){return this.scrollableElement.getScrollDimensions().width},set:function(t){this.scrollableElement.setScrollDimensions({width:t})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollWidth",{set:function(t){this.scrollableElement.setScrollDimensions({scrollWidth:t})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollTop",{get:function(){return this.scrollableElement.getScrollPosition().scrollTop},set:function(t){var e=this.getTotalRowsHeight()+(this.shouldShowHorizonalScrollbar?10:0);this.scrollableElement.setScrollDimensions({scrollHeight:e}),this.scrollableElement.setScrollPosition({scrollTop:t})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollLeft",{set:function(t){var e=this.getContentWidth()+(this.shouldShowVerticalScrollbar?10:0);this.scrollableElement.setScrollDimensions({scrollWidth:e}),this.scrollableElement.setScrollPosition({scrollLeft:t})},enumerable:!0,configurable:!0}),t.prototype.renderVerticalChanges=function(t,e){if(void 0===e&&(e=0),t){var n=e,i=e+t,o=this.indexAt(n),r=this.indexAt(i);if(o!==this.indexOfFirstMountedRow||r!==this.indexOfLastMountedRow){var s=-1,l=-1;if(this.indexOfLastMountedRow<r)s=this.indexOfLastMountedRow+1;else for(h=this.indexOfLastMountedRow;h>r&&this.mountedRows.length;)this.mountedRows.pop().dispose(),h--;if(this.indexOfFirstMountedRow>o)l=this.indexOfFirstMountedRow-1;else for(var h=this.indexOfFirstMountedRow;h<o&&this.mountedRows.length;)this.mountedRows.shift().dispose(),h++;if(!this.ctx.model.length)return;for(this.mountedRows.length||(l=-1,s=o);s>-1&&s<=r;){var u=this.createRowByIndex(s);this.mountedRows.length?u.mountAfter(this.mountedRows[this.mountedRows.length-1]):u.mountBefore(null),this.renderRow(u),this.mountedRows.push(u),s++}for(;l>-1&&l>=o;){var a=this.createRowByIndex(l);this.mountedRows.length?a.mountBefore(this.mountedRows[0]):a.mountBefore(null),this.renderRow(a),this.mountedRows.unshift(a),l--}this.indexOfLastMountedRow=r,this.indexOfFirstMountedRow=o}var c=this.ctx.options.rowHeight,d=this.getRowTop(o)-n;this.rowsContainer.style.top=M(d,c,-c)+"px"}},t.prototype.renderHorizonalChanges=function(t,e){void 0===e&&(e=0);var n=this.header.render(e,t),i=n.mounted,o=n.margin;this.memorizedMargin=o,this.memorizedMounted=i;for(var r=0,s=this.mountedRows.length;r<s;r++)this.mountedRows[r].updateCell(i,o)},t.prototype.renderHeader=function(t){var e=this.header.render(0,t),n=e.mounted,i=e.margin;this.memorizedMargin=i,this.memorizedMounted=n},t.prototype.renderRow=function(t){if(z(this.memorizedMounted)||z(this.memorizedMargin))throw new Error("not ready");t.updateCell(this.memorizedMounted,this.memorizedMargin)},t.prototype.handlePatchs=function(t){for(var e=this,n=[],i=0;i<this.indexOfFirstMountedRow;i++)n.push(null);for(var i=0,o=this.mountedRows.length;i<o;i++)(p=this.mountedRows[i]).unmount(),n[n.length]=p;for(var r=[],s=0,i=0;i<t.length;++i){var l=t[i];if(s!==l.oldPos&&r.push(n.slice(s,l.oldPos)),l.type===mn.Add){var h=l.items.map(function(t){return e.createRowByData(t)});r.push(h),s=l.oldPos}else{s=l.oldPos+l.items.length;for(var u=l.oldPos;u<s;u++){var a=n[u];a&&(a.dispose(),n[u]=null)}}}s!==n.length&&r.push(n.slice(s));for(var c=[].concat.apply([],r),d=Math.min(this.indexOfLastMountedRow,this.ctx.model.length-1),i=c.length;i<=d;i++){var p=this.createRowByIndex(i);c.push(p)}for(c=c.slice(this.indexOfFirstMountedRow,this.indexOfLastMountedRow+1),this.mountedRows.length=0;c.length;)(p=c.shift()).mounted||(p.mount(),this.renderRow(p)),this.mountedRows.push(p)},t.prototype.createRowByIndex=function(t){var e=this.ctx.model.get(t);return e instanceof fn?new Dn(this.rowsContainer,this.ctx,e):e instanceof pn?new An(this.rowsContainer,this.ctx,e):new En(this.rowsContainer,this.ctx,e)},t.prototype.createRowByData=function(t){return t instanceof fn?new Dn(this.rowsContainer,this.ctx,t):t instanceof pn?new An(this.rowsContainer,this.ctx,t):t?new En(this.rowsContainer,this.ctx,t):new Mn(this.rowsContainer,this.ctx)},t.prototype.getRowTop=function(t){return t*this.ctx.options.rowHeight+(t?1:0)},t.prototype.indexAt=function(t){var e,n=0,i=this.ctx.model.length-1,o=this.ctx.options.rowHeight;if(0===t)return 0;if(t>o*i)return i;for(;n<i;){e=Math.floor((n+i)/2);var r=this.getRowTop(e);if(t<r)i=e;else{if(!(t>=r+o))return e;if(n===e)break;n=e}}return n},t.prototype.indexAfter=function(t){return Math.min(this.indexAt(t)+1,this.ctx.model.length)},t.prototype.dispose=function(){this.header.dispose(),this.scrollableElement.dispose(),this.domNode.remove(),r(this.toDispose),this.toDispose.length=0},t.counter=0,t}(),On=function(){function t(t){this.field=t,this.type="avg"}return t.prototype.accumulate=function(t){for(var e=0,n=0,i=0,o=t.length;i<o;i++){var r=t[i][this.field];null==r||""===r||isNaN(r)||(e++,n+=parseFloat(r))}return 0!=e?n/e:NaN},t}(),Pn=function(){function t(t){this.field=t,this.type="max"}return t.prototype.accumulate=function(t){for(var e=NaN,n=0,i=t.length;n<i;n++){var o=t[n][this.field];isFinite(o)&&(e=isNaN(e)?o:Math.min(e,o))}return e},t}(),zn=function(){function t(t){this.field=t,this.type="max"}return t.prototype.accumulate=function(t){for(var e=NaN,n=0,i=t.length;n<i;n++){var o=t[n][this.field];isFinite(o)&&(e=isNaN(e)?o:Math.max(e,o))}return e},t}(),Tn=function(){function t(t){this.field=t,this.type="sum"}return t.prototype.accumulate=function(t){for(var e=0,n=0,i=t.length;n<i;n++){var o=t[n][this.field];isFinite(o)&&(e+=o)}return e},t}(),kn=function(){function t(t){this.field=t,this.type="count"}return t.prototype.accumulate=function(t){return t.length},t}();return{Grid:Ln,DataView:gn,AvgAggregator:On,MinAggregator:Pn,MaxAggregator:zn,SumAggregator:Tn,CountAggregator:kn,React:an,ReactDOM:cn}});
